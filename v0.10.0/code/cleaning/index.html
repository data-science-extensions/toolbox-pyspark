
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Helper files/functions/classes for generic PySpark processes">
      
      
        <meta name="author" content="[Chris Mahoney](mailto:chris@mahoneyconsultingservices.com)">
      
      
      
        <link rel="prev" href="../datetime/">
      
      
        <link rel="next" href="../duplication/">
      
      
      <link rel="icon" href="../../assets/images/spark.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Cleaning - PySpark Toolbox</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/style.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/admonitions.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/code_chunks.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/columns.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/lists.css">
    
      <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.4.2/css/all.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#toolbox_pyspark.cleaning" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="PySpark Toolbox" class="md-header__button md-logo" aria-label="PySpark Toolbox" data-md-component="logo">
      
  <img src="../../assets/images/spark.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PySpark Toolbox
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Cleaning
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/data-science-extensions/toolbox-pyspark" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m21.94 13.11-1.05-3.22c0-.03-.01-.06-.02-.09l-2.11-6.48a.86.86 0 0 0-.8-.57c-.36 0-.68.25-.79.58l-2 6.17H8.84L6.83 3.33a.85.85 0 0 0-.79-.58c-.37 0-.69.25-.8.58L3.13 9.82v.01l-1.07 3.28c-.16.5.01 1.04.44 1.34l9.22 6.71c.17.12.39.12.56-.01l9.22-6.7c.43-.3.6-.84.44-1.34M8.15 10.45l2.57 7.91-6.17-7.91m8.73 7.92 2.47-7.59.1-.33h3.61l-5.59 7.16m4.1-13.67 1.81 5.56h-3.62m-1.3.95-1.79 5.51L12 19.24l-2.86-8.79M6.03 3.94 7.84 9.5H4.23m-1.18 4.19c-.09-.07-.13-.19-.09-.29l.79-2.43 5.82 7.45m11.38-4.73-6.51 4.73.02-.03 5.79-7.42.79 2.43c.04.1 0 .22-.09.29"/></svg>
  </div>
  <div class="md-source__repository">
    toolbox-pyspark
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../usage/overview/" class="md-tabs__link">
          
  
    
  
  Usage

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  Modules

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PySpark Toolbox" class="md-nav__button md-logo" aria-label="PySpark Toolbox" data-md-component="logo">
      
  <img src="../../assets/images/spark.svg" alt="logo">

    </a>
    PySpark Toolbox
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/data-science-extensions/toolbox-pyspark" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m21.94 13.11-1.05-3.22c0-.03-.01-.06-.02-.09l-2.11-6.48a.86.86 0 0 0-.8-.57c-.36 0-.68.25-.79.58l-2 6.17H8.84L6.83 3.33a.85.85 0 0 0-.79-.58c-.37 0-.69.25-.8.58L3.13 9.82v.01l-1.07 3.28c-.16.5.01 1.04.44 1.34l9.22 6.71c.17.12.39.12.56-.01l9.22-6.7c.43-.3.6-.84.44-1.34M8.15 10.45l2.57 7.91-6.17-7.91m8.73 7.92 2.47-7.59.1-.33h3.61l-5.59 7.16m4.1-13.67 1.81 5.56h-3.62m-1.3.95-1.79 5.51L12 19.24l-2.86-8.79M6.03 3.94 7.84 9.5H4.23m-1.18 4.19c-.09-.07-.13-.19-.09-.29l.79-2.43 5.82 7.45m11.38-4.73-6.51 4.73.02-.03 5.79-7.42.79 2.43c.04.1 0 .22-.09.29"/></svg>
  </div>
  <div class="md-source__repository">
    toolbox-pyspark
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Usage
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/roadmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Roadmap
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Modules
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constants/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Constants
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IO
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../checks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Checks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../keys/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Keys
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scale/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scale
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dimensions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dimensions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../columns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Columns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datetime/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DateTime
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Cleaning
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Cleaning
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;cleaning
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" cleaning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning.create_empty_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_empty_dataframe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning.keep_first_record_by_columns" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;keep_first_record_by_columns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning.convert_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;convert_dataframe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning.get_column_values" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_column_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning.update_nullability" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_nullability
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning.trim_spaces_from_column" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;trim_spaces_from_column
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning.trim_spaces_from_columns" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;trim_spaces_from_columns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning.apply_function_to_column" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;apply_function_to_column
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning.apply_function_to_columns" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;apply_function_to_columns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning.drop_matching_rows" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;drop_matching_rows
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../duplication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Duplication
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;cleaning
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" cleaning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning.create_empty_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_empty_dataframe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning.keep_first_record_by_columns" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;keep_first_record_by_columns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning.convert_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;convert_dataframe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning.get_column_values" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_column_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning.update_nullability" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_nullability
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning.trim_spaces_from_column" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;trim_spaces_from_column
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning.trim_spaces_from_columns" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;trim_spaces_from_columns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning.apply_function_to_column" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;apply_function_to_column
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning.apply_function_to_columns" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;apply_function_to_columns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.cleaning.drop_matching_rows" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;drop_matching_rows
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/data-science-extensions/toolbox-pyspark/edit/main/docs/code/cleaning.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/data-science-extensions/toolbox-pyspark/raw/main/docs/code/cleaning.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


  <h1>Cleaning</h1>

<div class="doc doc-object doc-module">



<h3 id="toolbox_pyspark.cleaning" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">toolbox_pyspark.cleaning</span>


<a href="#toolbox_pyspark.cleaning" class="headerlink" title="Permanent link">🔗</a></h3>

    <div class="doc doc-contents first">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>The <code>cleaning</code> module is used to clean, fix, and fetch various aspects on a given DataFrame.</p>
</div>








  <div class="doc doc-children">



















































































































<div class="doc doc-object doc-function">


<h4 id="toolbox_pyspark.cleaning.create_empty_dataframe" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">create_empty_dataframe</span>


<a href="#toolbox_pyspark.cleaning.create_empty_dataframe" class="headerlink" title="Permanent link">🔗</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_empty_dataframe</span><span class="p">(</span>
    <span class="n">spark_session</span><span class="p">:</span> <span class="n">SparkSession</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span>
</code></pre></div>

    <div class="doc doc-contents ">

            <details class="quote">
              <summary>Source code in <code>src/toolbox_pyspark/cleaning.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span> <span class="nf">create_empty_dataframe</span><span class="p">(</span><span class="n">spark_session</span><span class="p">:</span> <span class="n">SparkSession</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">spark_session</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([],</span> <span class="n">T</span><span class="o">.</span><span class="n">StructType</span><span class="p">([]))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="toolbox_pyspark.cleaning.keep_first_record_by_columns" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">keep_first_record_by_columns</span>


<a href="#toolbox_pyspark.cleaning.keep_first_record_by_columns" class="headerlink" title="Permanent link">🔗</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">keep_first_record_by_columns</span><span class="p">(</span>
    <span class="n">dataframe</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">str_collection</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>For a given Spark <code class="highlight"><span class="n">DataFrame</span></code>, keep the first record given by the column(s) specified in <code class="highlight"><span class="n">columns</span></code>.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>The necessity for this function arose when we needed to perform a <code class="highlight"><span class="n">distinct</span><span class="p">()</span></code> function for a given <code class="highlight"><span class="n">DataFrame</span></code>; however, we still wanted to retain data provided in the other columns.</p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataframe</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame that you want to filter.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, <span title="toolbox_python.collection_types.str_collection">str_collection</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The single or multiple columns by which you want to extract the distinct values from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>TypeError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any of the inputs parsed to the parameters of this function are not the correct type. Uses the <a href="https://typeguard.readthedocs.io/en/stable/api.html#typeguard.typechecked"><code>@typeguard.typechecked</code></a> decorator.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ColumnDoesNotExistError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any of the <code class="highlight"><span class="n">columns</span></code> do not exist within <code class="highlight"><span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span></code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The updated dataframe, retaining only the first unique set of records from the columns specified in <code class="highlight"><span class="n">columns</span></code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Set up</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Imports</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">toolbox_pyspark.cleaning</span> <span class="kn">import</span> <span class="n">keep_first_record_by_columns</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Instantiate Spark</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="o">...</span>         <span class="p">{</span>
<span class="o">...</span>             <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;e&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="o">...</span>         <span class="p">}</span>
<span class="o">...</span>     <span class="p">)</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Check</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+---+
| a | b | c | d | e |
+---+---+---+---+---+
| 1 | a | 1 | 1 | 1 |
| 2 | b | 1 | 2 | 1 |
| 3 | c | 2 | 2 | 2 |
| 4 | d | 2 | 2 | 3 |
+---+---+---+---+---+
</code></pre></div>
</div></p>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Distinct by the `c` column</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">keep_first_record_by_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+---+
| a | b | c | d | e |
+---+---+---+---+---+
| 1 | a | 1 | 1 | 1 |
| 3 | c | 2 | 2 | 2 |
+---+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully kept first records by the <code>c</code> column.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Distinct by the `d` column</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">keep_first_record_by_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+---+
| a | b | c | d | e |
+---+---+---+---+---+
| 1 | a | 1 | 1 | 1 |
| 2 | b | 1 | 2 | 1 |
+---+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully kept first records by the <code>d</code> column.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: Distinct by the `e` column</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">keep_first_record_by_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+---+
| a | b | c | d | e |
+---+---+---+---+---+
| 1 | a | 1 | 1 | 1 |
| 3 | c | 2 | 2 | 2 |
| 4 | d | 2 | 2 | 3 |
+---+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully kept first records by the <code>e</code> column.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 4: Distinct by the `c` & `d` columns</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">keep_first_record_by_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+---+
| a | b | c | d | e |
+---+---+---+---+---+
| 1 | a | 1 | 1 | 1 |
| 2 | b | 1 | 2 | 1 |
| 3 | c | 2 | 2 | 2 |
+---+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully kept first records by the <code>c</code> &amp; <code>d</code> columns.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 5: Distinct by the `c` & `e` columns</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">keep_first_record_by_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+---+
| a | b | c | d | e |
+---+---+---+---+---+
| 1 | a | 1 | 1 | 1 |
| 3 | c | 2 | 2 | 2 |
| 4 | d | 2 | 2 | 3 |
+---+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully kept first records by the <code>c</code> &amp; <code>e</code> columns.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 6: Distinct by the `d` & `e` columns</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">keep_first_record_by_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+---+
| a | b | c | d | e |
+---+---+---+---+---+
| 1 | a | 1 | 1 | 1 |
| 2 | b | 1 | 2 | 1 |
| 3 | c | 2 | 2 | 2 |
| 4 | d | 2 | 2 | 3 |
+---+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully kept first records by the <code>d</code> &amp; <code>e</code> columns.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 7: Distinct by the `c`, `d` & `e` columns</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">keep_first_record_by_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+---+
| a | b | c | d | e |
+---+---+---+---+---+
| 1 | a | 1 | 1 | 1 |
| 2 | b | 1 | 2 | 1 |
| 3 | c | 2 | 2 | 2 |
| 4 | d | 2 | 2 | 3 |
+---+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully kept first records by the <code>c</code>, <code>d</code> &amp; <code>e</code> columns.</p>
</div>
<div class="admonition failure">
<p class="admonition-title">Conclusion: Failure.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 8: Column missing</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">keep_first_record_by_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>ColumnDoesNotExistError: Column &#39;f&#39; does not exist in the DataFrame.
Try one of: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;]
</code></pre></div></p>
<div class="admonition failure">
<p class="admonition-title">Conclusion: Column missing.</p>
</div>
</div>
</details>
<details class="info">
<summary>Notes</summary>
<p>The way this process will retain only the first record in the given <code class="highlight"><span class="n">columns</span></code> is by:</p>
<ol>
<li>Add a new column called <code>RowNum</code><ol>
<li>This <code>RowNum</code> column uses the SparkSQL function <code class="highlight"><span class="n">ROW_NUMBER</span><span class="p">()</span></code></li>
<li>The window-function <code class="highlight"><span class="n">OVER</span></code> clause will then:<ol>
<li><code class="highlight"><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span></code> the <code class="highlight"><span class="n">columns</span></code>,</li>
<li><code class="highlight"><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span></code> the <code class="highlight"><span class="n">columns</span></code>.</li>
</ol>
</li>
</ol>
</li>
<li>Filter so that <code class="highlight"><span class="n">RowNum</span><span class="o">=</span><span class="mi">1</span></code>.</li>
<li>Drop the <code class="highlight"><span class="n">RowNum</span></code> column.</li>
</ol>
</details>
<details class="tip" open="open">
<summary>See Also</summary>
<ul>
<li><a class="autorefs autorefs-internal" href="../checks/#toolbox_pyspark.checks.assert_columns_exists"><code>toolbox_pyspark.checks.assert_columns_exists()</code></a></li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>src/toolbox_pyspark/cleaning.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span> <span class="nf">keep_first_record_by_columns</span><span class="p">(</span>
    <span class="n">dataframe</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">str_collection</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        For a given Spark `#!py DataFrame`, keep the first record given by the column(s) specified in `#!py columns`.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>
<span class="sd">        The necessity for this function arose when we needed to perform a `#!py distinct()` function for a given `#!py DataFrame`; however, we still wanted to retain data provided in the other columns.</span>

<span class="sd">    Params:</span>
<span class="sd">        dataframe (psDataFrame):</span>
<span class="sd">            The DataFrame that you want to filter.</span>
<span class="sd">        columns (Union[str, str_collection]):</span>
<span class="sd">            The single or multiple columns by which you want to extract the distinct values from.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError:</span>
<span class="sd">            If any of the inputs parsed to the parameters of this function are not the correct type. Uses the [`@typeguard.typechecked`](https://typeguard.readthedocs.io/en/stable/api.html#typeguard.typechecked) decorator.</span>
<span class="sd">        ColumnDoesNotExistError:</span>
<span class="sd">            If any of the `#!py columns` do not exist within `#!py dataframe.columns`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (psDataFrame):</span>
<span class="sd">            The updated dataframe, retaining only the first unique set of records from the columns specified in `#!py columns`.</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Set up&quot;}</span>
<span class="sd">        &gt;&gt;&gt; # Imports</span>
<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; from pyspark.sql import SparkSession</span>
<span class="sd">        &gt;&gt;&gt; from toolbox_pyspark.cleaning import keep_first_record_by_columns</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Instantiate Spark</span>
<span class="sd">        &gt;&gt;&gt; spark = SparkSession.builder.getOrCreate()</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Create data</span>
<span class="sd">        &gt;&gt;&gt; df = spark.createDataFrame(</span>
<span class="sd">        ...     pd.DataFrame(</span>
<span class="sd">        ...         {</span>
<span class="sd">        ...             &quot;a&quot;: [1, 2, 3, 4],</span>
<span class="sd">        ...             &quot;b&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;],</span>
<span class="sd">        ...             &quot;c&quot;: [1, 1, 2, 2],</span>
<span class="sd">        ...             &quot;d&quot;: [1, 2, 2, 2],</span>
<span class="sd">        ...             &quot;e&quot;: [1, 1, 2, 3],</span>
<span class="sd">        ...         }</span>
<span class="sd">        ...     )</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Check</span>
<span class="sd">        &gt;&gt;&gt; df.show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | a | b | c | d | e |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | 1 | a | 1 | 1 | 1 |</span>
<span class="sd">        | 2 | b | 1 | 2 | 1 |</span>
<span class="sd">        | 3 | c | 2 | 2 | 2 |</span>
<span class="sd">        | 4 | d | 2 | 2 | 3 |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 1: Distinct by the `c` column&quot;}</span>
<span class="sd">        &gt;&gt;&gt; keep_first_record_by_columns(df, &quot;c&quot;).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | a | b | c | d | e |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | 1 | a | 1 | 1 | 1 |</span>
<span class="sd">        | 3 | c | 2 | 2 | 2 |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully kept first records by the `c` column.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 2: Distinct by the `d` column&quot;}</span>
<span class="sd">        &gt;&gt;&gt; keep_first_record_by_columns(df, &quot;d&quot;).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | a | b | c | d | e |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | 1 | a | 1 | 1 | 1 |</span>
<span class="sd">        | 2 | b | 1 | 2 | 1 |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully kept first records by the `d` column.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 3: Distinct by the `e` column&quot;}</span>
<span class="sd">        &gt;&gt;&gt; keep_first_record_by_columns(df, &quot;e&quot;).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | a | b | c | d | e |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | 1 | a | 1 | 1 | 1 |</span>
<span class="sd">        | 3 | c | 2 | 2 | 2 |</span>
<span class="sd">        | 4 | d | 2 | 2 | 3 |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully kept first records by the `e` column.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 4: Distinct by the `c` &amp; `d` columns&quot;}</span>
<span class="sd">        &gt;&gt;&gt; keep_first_record_by_columns(df, [&quot;c&quot;, &quot;d&quot;]).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | a | b | c | d | e |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | 1 | a | 1 | 1 | 1 |</span>
<span class="sd">        | 2 | b | 1 | 2 | 1 |</span>
<span class="sd">        | 3 | c | 2 | 2 | 2 |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully kept first records by the `c` &amp; `d` columns.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 5: Distinct by the `c` &amp; `e` columns&quot;}</span>
<span class="sd">        &gt;&gt;&gt; keep_first_record_by_columns(df, [&quot;c&quot;, &quot;e&quot;]).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | a | b | c | d | e |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | 1 | a | 1 | 1 | 1 |</span>
<span class="sd">        | 3 | c | 2 | 2 | 2 |</span>
<span class="sd">        | 4 | d | 2 | 2 | 3 |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully kept first records by the `c` &amp; `e` columns.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 6: Distinct by the `d` &amp; `e` columns&quot;}</span>
<span class="sd">        &gt;&gt;&gt; keep_first_record_by_columns(df, [&quot;d&quot;, &quot;e&quot;]).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | a | b | c | d | e |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | 1 | a | 1 | 1 | 1 |</span>
<span class="sd">        | 2 | b | 1 | 2 | 1 |</span>
<span class="sd">        | 3 | c | 2 | 2 | 2 |</span>
<span class="sd">        | 4 | d | 2 | 2 | 3 |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully kept first records by the `d` &amp; `e` columns.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 7: Distinct by the `c`, `d` &amp; `e` columns&quot;}</span>
<span class="sd">        &gt;&gt;&gt; keep_first_record_by_columns(df, [&quot;c&quot;, &quot;d&quot;, &quot;e&quot;]).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | a | b | c | d | e |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | 1 | a | 1 | 1 | 1 |</span>
<span class="sd">        | 2 | b | 1 | 2 | 1 |</span>
<span class="sd">        | 3 | c | 2 | 2 | 2 |</span>
<span class="sd">        | 4 | d | 2 | 2 | 3 |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully kept first records by the `c`, `d` &amp; `e` columns.&quot;</span>
<span class="sd">        !!! failure &quot;Conclusion: Failure.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 8: Column missing&quot;}</span>
<span class="sd">        &gt;&gt;&gt; keep_first_record_by_columns(df, &quot;f&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        ColumnDoesNotExistError: Column &#39;f&#39; does not exist in the DataFrame.</span>
<span class="sd">        Try one of: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;]</span>
<span class="sd">        ```</span>
<span class="sd">        !!! failure &quot;Conclusion: Column missing.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">    ??? info &quot;Notes&quot;</span>
<span class="sd">        The way this process will retain only the first record in the given `#!py columns` is by:</span>

<span class="sd">        1. Add a new column called `RowNum`</span>
<span class="sd">            1. This `RowNum` column uses the SparkSQL function `#!sql ROW_NUMBER()`</span>
<span class="sd">            1. The window-function `#!sql OVER` clause will then:</span>
<span class="sd">                1. `#!sql PARTITION BY` the `#!py columns`,</span>
<span class="sd">                1. `#!sql ORDER BY` the `#!py columns`.</span>
<span class="sd">        1. Filter so that `#!sql RowNum=1`.</span>
<span class="sd">        1. Drop the `#!py RowNum` column.</span>

<span class="sd">    ???+ tip &quot;See Also&quot;</span>
<span class="sd">        - [`toolbox_pyspark.checks.assert_columns_exists()`][toolbox_pyspark.checks.assert_columns_exists]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">columns</span><span class="p">]</span> <span class="k">if</span> <span class="n">is_type</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">columns</span>
    <span class="n">assert_columns_exists</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">dataframe</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="n">colName</span><span class="o">=</span><span class="s2">&quot;RowNum&quot;</span><span class="p">,</span>
            <span class="n">col</span><span class="o">=</span><span class="n">F</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                ROW_NUMBER()</span>
<span class="s2">                OVER</span>
<span class="s2">                (</span>
<span class="s2">                    PARTITION BY </span><span class="si">{</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span>
<span class="s2">                    ORDER BY </span><span class="si">{</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span>
<span class="s2">                )</span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="p">),</span>
        <span class="p">)</span>
        <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;RowNum=1&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;RowNum&quot;</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="toolbox_pyspark.cleaning.convert_dataframe" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">convert_dataframe</span>


<a href="#toolbox_pyspark.cleaning.convert_dataframe" class="headerlink" title="Permanent link">🔗</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">convert_dataframe</span><span class="p">(</span>
    <span class="n">dataframe</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">return_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
        <span class="n">LITERAL_PYSPARK_DATAFRAME_NAMES</span><span class="p">,</span>
        <span class="n">LITERAL_PANDAS_DATAFRAME_NAMES</span><span class="p">,</span>
        <span class="n">LITERAL_NUMPY_ARRAY_NAMES</span><span class="p">,</span>
        <span class="n">LITERAL_LIST_OBJECT_NAMES</span><span class="p">,</span>
        <span class="nb">str</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pd&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span>
    <span class="n">Union</span><span class="p">[</span><span class="n">psDataFrame</span><span class="p">,</span> <span class="n">pdDataFrame</span><span class="p">,</span> <span class="n">npArray</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span>
<span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>Convert a PySpark DataFrame to the desired return type.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>This function converts a PySpark DataFrame to one of the supported return types, including:</p>
<p>PySpark DataFrame:</p>
<div class="mdx-four-columns" markdown>
<ul>
<li><code class="highlight"><span class="s2">&quot;spark.DataFrame&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;pyspark.DataFrame&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;pyspark&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;spark&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;ps.DataFrame&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;ps.df&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;psdf&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;psDataFrame&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;psDF&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;ps&quot;</span></code></li>
</ul>
</div>
<p>Pandas DataFrame:</p>
<div class="mdx-four-columns" markdown>
<ul>
<li><code class="highlight"><span class="s2">&quot;pandas.DataFrame&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;pandas&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;pd.DataFrame&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;pd.df&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;pddf&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;pdDataFrame&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;pdDF&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;pd&quot;</span></code></li>
</ul>
</div>
<p>NumPy array:</p>
<div class="mdx-four-columns" markdown>
<ul>
<li><code class="highlight"><span class="s2">&quot;numpy.array&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;np.array&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;np&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;numpy&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;nparr&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;npa&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;np.arr&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;np.a&quot;</span></code></li>
</ul>
</div>
<p>Python list:</p>
<div class="mdx-four-columns" markdown>
<ul>
<li><code class="highlight"><span class="s2">&quot;list&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;lst&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;l&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;flat_list&quot;</span></code></li>
<li><code class="highlight"><span class="s2">&quot;flatten_list&quot;</span></code></li>
</ul>
</div>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataframe</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PySpark DataFrame to be converted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_type</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="toolbox_pyspark.constants.LITERAL_LIST_OBJECT_NAMES" href="../constants/#toolbox_pyspark.constants.LITERAL_LIST_OBJECT_NAMES">LITERAL_LIST_OBJECT_NAMES</a>, <a class="autorefs autorefs-internal" title="toolbox_pyspark.constants.LITERAL_PANDAS_DATAFRAME_NAMES" href="../constants/#toolbox_pyspark.constants.LITERAL_PANDAS_DATAFRAME_NAMES">LITERAL_PANDAS_DATAFRAME_NAMES</a>, <a class="autorefs autorefs-internal" title="toolbox_pyspark.constants.LITERAL_PYSPARK_DATAFRAME_NAMES" href="../constants/#toolbox_pyspark.constants.LITERAL_PYSPARK_DATAFRAME_NAMES">LITERAL_PYSPARK_DATAFRAME_NAMES</a>, <a class="autorefs autorefs-internal" title="toolbox_pyspark.constants.LITERAL_NUMPY_ARRAY_NAMES" href="../constants/#toolbox_pyspark.constants.LITERAL_NUMPY_ARRAY_NAMES">LITERAL_NUMPY_ARRAY_NAMES</a>, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The desired return type.<br>
Options:</p>
<ul>
<li><code class="highlight"><span class="s2">&quot;ps&quot;</span></code>: Return the PySpark DataFrame.</li>
<li><code class="highlight"><span class="s2">&quot;pd&quot;</span></code>: Return a Pandas DataFrame.</li>
<li><code class="highlight"><span class="s2">&quot;np&quot;</span></code>: Return a NumPy array.</li>
<li><code class="highlight"><span class="s2">&quot;list&quot;</span></code>: Return a Python list.</li>
<li><code class="highlight"><span class="s2">&quot;list_flat&quot;</span></code>: Return a flat Python list (1D).</li>
</ul>
<p>Defaults to <code class="highlight"><span class="s2">&quot;pd&quot;</span></code> (Pandas DataFrame).</p>
              </div>
            </td>
            <td>
                  <code>&#39;pd&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>TypeError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any of the inputs parsed to the parameters of this function are not the correct type. Uses the <a href="https://typeguard.readthedocs.io/en/stable/api.html#typeguard.typechecked"><code>@typeguard.typechecked</code></a> decorator.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any of the values parsed to <code>return_type</code> are not valid options.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="pyspark.sql.DataFrame">DataFrame</span>, <span title="pandas.DataFrame">DataFrame</span>, <span title="numpy.ndarray">ndarray</span>, list]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The converted data in the specified return type.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Set up</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Imports</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">toolbox_pyspark.cleaning</span> <span class="kn">import</span> <span class="n">convert_dataframe</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Instantiate Spark</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">pdDataFrame</span><span class="p">(</span>
<span class="o">...</span>         <span class="p">{</span>
<span class="o">...</span>             <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
<span class="o">...</span>         <span class="p">}</span>
<span class="o">...</span>     <span class="p">)</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Check</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+
| a | b |
+---+---+
| 0 | a |
| 1 | b |
| 2 | c |
| 3 | d |
+---+---+
</code></pre></div></p>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Convert to PySpark</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">new_df</span> <span class="o">=</span> <span class="n">convert_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;ps&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">new_df</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">new_df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>&lt;class &#39;pyspark.sql.dataframe.DataFrame&#39;&gt;
</code></pre></div>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+
| a | b |
+---+---+
| 0 | a |
| 1 | b |
| 2 | c |
| 3 | d |
+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully converted to PySpark.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Convert to Pandas</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">new_df</span> <span class="o">=</span> <span class="n">convert_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;pd&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">new_df</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">new_df</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
</code></pre></div>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>   a  b
0  0  a
1  1  b
2  2  c
3  3  d
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully converted to Pandas.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: Convert to Numpy</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">new_df</span> <span class="o">=</span> <span class="n">convert_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;np&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">new_df</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">new_df</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>&lt;class &#39;numpy.ndarray&#39;&gt;
</code></pre></div>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>[[0 &quot;a&quot;]
 [1 &quot;b&quot;]
 [2 &quot;c&quot;]
 [3 &quot;d&quot;]]
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully converted to Numpy.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 4: List</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">new_df</span> <span class="o">=</span> <span class="n">convert_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;list&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">new_df</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">new_df</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>&lt;class &#39;list&#39;&gt;
</code></pre></div>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>[
    [0, &quot;a&quot;],
    [1, &quot;b&quot;],
    [2, &quot;c&quot;],
    [3, &quot;d&quot;],
]
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully converted to List.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 5: Convert to single column as list</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">new_df</span> <span class="o">=</span> <span class="n">convert_dataframe</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">),</span> <span class="s2">&quot;flat_list&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">new_df</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">new_df</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>&lt;class &#39;list&#39;&gt;
</code></pre></div>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>[&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;]
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully converted to flat List.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 6: Invalid return type</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">convert_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;invalid&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>ValueError: Unknown return type: &#39;invalid&#39;.
Must be one of: [&#39;pd&#39;, &#39;ps&#39;, &#39;np&#39;, &#39;list&#39;].
For more info, check the `constants` module.
</code></pre></div></p>
<div class="admonition failure">
<p class="admonition-title">Conclusion: Invalid return type.</p>
</div>
</div>
</details>
<details class="tip" open="open">
<summary>See Also</summary>
<ul>
<li><a class="autorefs autorefs-internal" href="../constants/#toolbox_pyspark.constants"><code>toolbox_pyspark.constants</code></a></li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>src/toolbox_pyspark/cleaning.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span> <span class="nf">convert_dataframe</span><span class="p">(</span>
    <span class="n">dataframe</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">return_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
        <span class="n">LITERAL_PYSPARK_DATAFRAME_NAMES</span><span class="p">,</span>
        <span class="n">LITERAL_PANDAS_DATAFRAME_NAMES</span><span class="p">,</span>
        <span class="n">LITERAL_NUMPY_ARRAY_NAMES</span><span class="p">,</span>
        <span class="n">LITERAL_LIST_OBJECT_NAMES</span><span class="p">,</span>
        <span class="nb">str</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pd&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">psDataFrame</span><span class="p">,</span> <span class="n">pdDataFrame</span><span class="p">,</span> <span class="n">npArray</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        Convert a PySpark DataFrame to the desired return type.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>
<span class="sd">        This function converts a PySpark DataFrame to one of the supported return types, including:</span>

<span class="sd">        PySpark DataFrame:</span>

<span class="sd">        &lt;div class=&quot;mdx-four-columns&quot; markdown&gt;</span>

<span class="sd">        - `#!py &quot;spark.DataFrame&quot;`</span>
<span class="sd">        - `#!py &quot;pyspark.DataFrame&quot;`</span>
<span class="sd">        - `#!py &quot;pyspark&quot;`</span>
<span class="sd">        - `#!py &quot;spark&quot;`</span>
<span class="sd">        - `#!py &quot;ps.DataFrame&quot;`</span>
<span class="sd">        - `#!py &quot;ps.df&quot;`</span>
<span class="sd">        - `#!py &quot;psdf&quot;`</span>
<span class="sd">        - `#!py &quot;psDataFrame&quot;`</span>
<span class="sd">        - `#!py &quot;psDF&quot;`</span>
<span class="sd">        - `#!py &quot;ps&quot;`</span>

<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        Pandas DataFrame:</span>

<span class="sd">        &lt;div class=&quot;mdx-four-columns&quot; markdown&gt;</span>

<span class="sd">        - `#!py &quot;pandas.DataFrame&quot;`</span>
<span class="sd">        - `#!py &quot;pandas&quot;`</span>
<span class="sd">        - `#!py &quot;pd.DataFrame&quot;`</span>
<span class="sd">        - `#!py &quot;pd.df&quot;`</span>
<span class="sd">        - `#!py &quot;pddf&quot;`</span>
<span class="sd">        - `#!py &quot;pdDataFrame&quot;`</span>
<span class="sd">        - `#!py &quot;pdDF&quot;`</span>
<span class="sd">        - `#!py &quot;pd&quot;`</span>

<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        NumPy array:</span>

<span class="sd">        &lt;div class=&quot;mdx-four-columns&quot; markdown&gt;</span>

<span class="sd">        - `#!py &quot;numpy.array&quot;`</span>
<span class="sd">        - `#!py &quot;np.array&quot;`</span>
<span class="sd">        - `#!py &quot;np&quot;`</span>
<span class="sd">        - `#!py &quot;numpy&quot;`</span>
<span class="sd">        - `#!py &quot;nparr&quot;`</span>
<span class="sd">        - `#!py &quot;npa&quot;`</span>
<span class="sd">        - `#!py &quot;np.arr&quot;`</span>
<span class="sd">        - `#!py &quot;np.a&quot;`</span>

<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        Python list:</span>

<span class="sd">        &lt;div class=&quot;mdx-four-columns&quot; markdown&gt;</span>

<span class="sd">        - `#!py &quot;list&quot;`</span>
<span class="sd">        - `#!py &quot;lst&quot;`</span>
<span class="sd">        - `#!py &quot;l&quot;`</span>
<span class="sd">        - `#!py &quot;flat_list&quot;`</span>
<span class="sd">        - `#!py &quot;flatten_list&quot;`</span>

<span class="sd">        &lt;/div&gt;</span>

<span class="sd">    Params:</span>
<span class="sd">        dataframe (psDataFrame):</span>
<span class="sd">            The PySpark DataFrame to be converted.</span>
<span class="sd">        return_type (Union[LITERAL_LIST_OBJECT_NAMES, LITERAL_PANDAS_DATAFRAME_NAMES, LITERAL_PYSPARK_DATAFRAME_NAMES, LITERAL_NUMPY_ARRAY_NAMES, str], optional):</span>
<span class="sd">            The desired return type.&lt;br&gt;</span>
<span class="sd">            Options:</span>

<span class="sd">            - `#!py &quot;ps&quot;`: Return the PySpark DataFrame.</span>
<span class="sd">            - `#!py &quot;pd&quot;`: Return a Pandas DataFrame.</span>
<span class="sd">            - `#!py &quot;np&quot;`: Return a NumPy array.</span>
<span class="sd">            - `#!py &quot;list&quot;`: Return a Python list.</span>
<span class="sd">            - `#!py &quot;list_flat&quot;`: Return a flat Python list (1D).</span>

<span class="sd">            Defaults to `#!py &quot;pd&quot;` (Pandas DataFrame).</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError:</span>
<span class="sd">            If any of the inputs parsed to the parameters of this function are not the correct type. Uses the [`@typeguard.typechecked`](https://typeguard.readthedocs.io/en/stable/api.html#typeguard.typechecked) decorator.</span>
<span class="sd">        ValueError:</span>
<span class="sd">            If any of the values parsed to `return_type` are not valid options.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Optional[Union[psDataFrame, pdDataFrame, npArray, list]]):</span>
<span class="sd">            The converted data in the specified return type.</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Set up&quot;}</span>
<span class="sd">        &gt;&gt;&gt; # Imports</span>
<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; from pyspark.sql import SparkSession</span>
<span class="sd">        &gt;&gt;&gt; from toolbox_pyspark.cleaning import convert_dataframe</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Instantiate Spark</span>
<span class="sd">        &gt;&gt;&gt; spark = SparkSession.builder.getOrCreate()</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Create data</span>
<span class="sd">        &gt;&gt;&gt; df = spark.createDataFrame(</span>
<span class="sd">        ...     pdDataFrame(</span>
<span class="sd">        ...         {</span>
<span class="sd">        ...             &quot;a&quot;: [1, 2, 3, 4],</span>
<span class="sd">        ...             &quot;b&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;],</span>
<span class="sd">        ...         }</span>
<span class="sd">        ...     )</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Check</span>
<span class="sd">        &gt;&gt;&gt; df.show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+</span>
<span class="sd">        | a | b |</span>
<span class="sd">        +---+---+</span>
<span class="sd">        | 0 | a |</span>
<span class="sd">        | 1 | b |</span>
<span class="sd">        | 2 | c |</span>
<span class="sd">        | 3 | d |</span>
<span class="sd">        +---+---+</span>
<span class="sd">        ```</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 1: Convert to PySpark&quot;}</span>
<span class="sd">        &gt;&gt;&gt; new_df = convert_dataframe(df, &quot;ps&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(type(new_df))</span>
<span class="sd">        &gt;&gt;&gt; new_df.show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        &lt;class &#39;pyspark.sql.dataframe.DataFrame&#39;&gt;</span>
<span class="sd">        ```</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+</span>
<span class="sd">        | a | b |</span>
<span class="sd">        +---+---+</span>
<span class="sd">        | 0 | a |</span>
<span class="sd">        | 1 | b |</span>
<span class="sd">        | 2 | c |</span>
<span class="sd">        | 3 | d |</span>
<span class="sd">        +---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully converted to PySpark.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 2: Convert to Pandas&quot;}</span>
<span class="sd">        &gt;&gt;&gt; new_df = convert_dataframe(df, &quot;pd&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(type(new_df))</span>
<span class="sd">        &gt;&gt;&gt; print(new_df)</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</span>
<span class="sd">        ```</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">           a  b</span>
<span class="sd">        0  0  a</span>
<span class="sd">        1  1  b</span>
<span class="sd">        2  2  c</span>
<span class="sd">        3  3  d</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully converted to Pandas.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 3: Convert to Numpy&quot;}</span>
<span class="sd">        &gt;&gt;&gt; new_df = convert_dataframe(df, &quot;np&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(type(new_df))</span>
<span class="sd">        &gt;&gt;&gt; print(new_df)</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        &lt;class &#39;numpy.ndarray&#39;&gt;</span>
<span class="sd">        ```</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        [[0 &quot;a&quot;]</span>
<span class="sd">         [1 &quot;b&quot;]</span>
<span class="sd">         [2 &quot;c&quot;]</span>
<span class="sd">         [3 &quot;d&quot;]]</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully converted to Numpy.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 4: List&quot;}</span>
<span class="sd">        &gt;&gt;&gt; new_df = convert_dataframe(df, &quot;list&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(type(new_df))</span>
<span class="sd">        &gt;&gt;&gt; print(new_df)</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        &lt;class &#39;list&#39;&gt;</span>
<span class="sd">        ```</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        [</span>
<span class="sd">            [0, &quot;a&quot;],</span>
<span class="sd">            [1, &quot;b&quot;],</span>
<span class="sd">            [2, &quot;c&quot;],</span>
<span class="sd">            [3, &quot;d&quot;],</span>
<span class="sd">        ]</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully converted to List.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 5: Convert to single column as list&quot;}</span>
<span class="sd">        &gt;&gt;&gt; new_df = convert_dataframe(df.select(&quot;b&quot;), &quot;flat_list&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(type(new_df))</span>
<span class="sd">        &gt;&gt;&gt; print(new_df)</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        &lt;class &#39;list&#39;&gt;</span>
<span class="sd">        ```</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;]</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully converted to flat List.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 6: Invalid return type&quot;}</span>
<span class="sd">        &gt;&gt;&gt; convert_dataframe(df, &quot;invalid&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        ValueError: Unknown return type: &#39;invalid&#39;.</span>
<span class="sd">        Must be one of: [&#39;pd&#39;, &#39;ps&#39;, &#39;np&#39;, &#39;list&#39;].</span>
<span class="sd">        For more info, check the `constants` module.</span>
<span class="sd">        ```</span>
<span class="sd">        !!! failure &quot;Conclusion: Invalid return type.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">    ???+ tip &quot;See Also&quot;</span>
<span class="sd">        - [`toolbox_pyspark.constants`][toolbox_pyspark.constants]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">return_type</span> <span class="ow">in</span> <span class="n">VALID_PYSPARK_DATAFRAME_NAMES</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dataframe</span>
    <span class="k">elif</span> <span class="n">return_type</span> <span class="ow">in</span> <span class="n">VALID_PANDAS_DATAFRAME_NAMES</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">return_type</span> <span class="ow">in</span> <span class="n">VALID_NUMPY_ARRAY_NAMES</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># type:ignore</span>
    <span class="k">elif</span> <span class="n">return_type</span> <span class="ow">in</span> <span class="n">VALID_LIST_OBJECT_NAMES</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;flat&quot;</span> <span class="ow">in</span> <span class="n">return_type</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">flatten</span><span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>  <span class="c1"># type:ignore</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>  <span class="c1"># type:ignore</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Unknown return type: &#39;</span><span class="si">{</span><span class="n">return_type</span><span class="si">}</span><span class="s2">&#39;.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Must be one of: </span><span class="si">{</span><span class="p">[</span><span class="s1">&#39;pd&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ps&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;np&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;list&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;For more info, check the `constants` module.&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="toolbox_pyspark.cleaning.get_column_values" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_column_values</span>


<a href="#toolbox_pyspark.cleaning.get_column_values" class="headerlink" title="Permanent link">🔗</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_column_values</span><span class="p">(</span>
    <span class="n">dataframe</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">distinct</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
        <span class="n">LITERAL_PYSPARK_DATAFRAME_NAMES</span><span class="p">,</span>
        <span class="n">LITERAL_PANDAS_DATAFRAME_NAMES</span><span class="p">,</span>
        <span class="n">LITERAL_NUMPY_ARRAY_NAMES</span><span class="p">,</span>
        <span class="n">LITERAL_LIST_OBJECT_NAMES</span><span class="p">,</span>
        <span class="nb">str</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pd&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span>
    <span class="n">Union</span><span class="p">[</span><span class="n">psDataFrame</span><span class="p">,</span> <span class="n">pdDataFrame</span><span class="p">,</span> <span class="n">npArray</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span>
<span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>Extract and return unique values from a specified column of a PySpark DataFrame.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>This function retrieves the unique values from a specified column of a PySpark DataFrame.</p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataframe</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input PySpark DataFrame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>column</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the column from which to extract unique values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>distinct</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code class="highlight"><span class="kc">True</span></code>, return distinct (unique) values.<br>
Defaults to <code class="highlight"><span class="kc">True</span></code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_type</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="toolbox_pyspark.constants.LITERAL_LIST_OBJECT_NAMES" href="../constants/#toolbox_pyspark.constants.LITERAL_LIST_OBJECT_NAMES">LITERAL_LIST_OBJECT_NAMES</a>, <a class="autorefs autorefs-internal" title="toolbox_pyspark.constants.LITERAL_PANDAS_DATAFRAME_NAMES" href="../constants/#toolbox_pyspark.constants.LITERAL_PANDAS_DATAFRAME_NAMES">LITERAL_PANDAS_DATAFRAME_NAMES</a>, <a class="autorefs autorefs-internal" title="toolbox_pyspark.constants.LITERAL_PYSPARK_DATAFRAME_NAMES" href="../constants/#toolbox_pyspark.constants.LITERAL_PYSPARK_DATAFRAME_NAMES">LITERAL_PYSPARK_DATAFRAME_NAMES</a>, <a class="autorefs autorefs-internal" title="toolbox_pyspark.constants.LITERAL_NUMPY_ARRAY_NAMES" href="../constants/#toolbox_pyspark.constants.LITERAL_NUMPY_ARRAY_NAMES">LITERAL_NUMPY_ARRAY_NAMES</a>, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The desired return type.<br>
Options:</p>
<ul>
<li><code class="highlight"><span class="s2">&quot;ps&quot;</span></code>: Return the result as a PySpark DataFrame.</li>
<li><code class="highlight"><span class="s2">&quot;pd&quot;</span></code>: Return the result as a Pandas DataFrame.</li>
<li><code class="highlight"><span class="s2">&quot;np&quot;</span></code>: Return the result as a NumPy array.</li>
<li><code class="highlight"><span class="s2">&quot;list&quot;</span></code>: Return the result as a Python list.</li>
</ul>
<p>Defaults to <code class="highlight"><span class="s2">&quot;pd&quot;</span></code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;pd&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>TypeError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any of the inputs parsed to the parameters of this function are not the correct type. Uses the <a href="https://typeguard.readthedocs.io/en/stable/api.html#typeguard.typechecked"><code>@typeguard.typechecked</code></a> decorator.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any of the values parsed to <code>return_type</code> are not valid options.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ColumnDoesNotExistError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the <code class="highlight"><span class="n">column</span></code> does not exist within <code class="highlight"><span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span></code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="pyspark.sql.DataFrame">DataFrame</span>, <span title="pandas.DataFrame">DataFrame</span>, <span title="numpy.ndarray">ndarray</span>, list]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The values from the given column, in the desired type.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Set up</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Imports</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">toolbox_pyspark.cleaning</span> <span class="kn">import</span> <span class="n">get_column_values</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Instantiate Spark</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="o">...</span>         <span class="p">{</span>
<span class="o">...</span>             <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
<span class="o">...</span>         <span class="p">}</span>
<span class="o">...</span>     <span class="p">)</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Check</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+
| a | b | c | d |
+---+---+---+---+
| 0 | a | c | d |
| 1 | b | c | d |
| 2 | c | c | d |
| 3 | d | c | d |
+---+---+---+---+
</code></pre></div>
</div></p>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Default params</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">values</span> <span class="o">=</span> <span class="n">get_column_values</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
</code></pre></div>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>  c
0 c
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully extracted distinct values from the <code>c</code> column, and converted to Pandas.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Not distinct</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">values</span> <span class="o">=</span> <span class="n">get_column_values</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
</code></pre></div>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>  c
0 c
1 c
2 c
3 c
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully extracted values from the <code>c</code> column, and converted to Pandas.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: Flat list</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">values</span> <span class="o">=</span> <span class="n">get_column_values</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;flat_list&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>&lt;class &#39;list&#39;&gt;
</code></pre></div>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>[&quot;c&quot;, &quot;c&quot;, &quot;c&quot;, &quot;c&quot;]
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully extracted values from the <code>c</code> column, and converted to flat List.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 4: Invalid return type</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">get_column_values</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;invalid&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>ValueError: Unknown return type: &#39;invalid&#39;.
Must be one of: [&#39;pd&#39;, &#39;ps&#39;, &#39;np&#39;, &#39;list&#39;].
For more info, check the `constants` module.
</code></pre></div></p>
<div class="admonition failure">
<p class="admonition-title">Conclusion: Invalid return type.</p>
</div>
</div>
</details>
<details class="tip" open="open">
<summary>See Also</summary>
<ul>
<li><a class="autorefs autorefs-internal" href="#toolbox_pyspark.cleaning.convert_dataframe"><code>toolbox_pyspark.cleaning.convert_dataframe()</code></a></li>
<li><a class="autorefs autorefs-internal" href="../constants/#toolbox_pyspark.constants"><code>toolbox_pyspark.constants</code></a></li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>src/toolbox_pyspark/cleaning.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span> <span class="nf">get_column_values</span><span class="p">(</span>
    <span class="n">dataframe</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">distinct</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
        <span class="n">LITERAL_PYSPARK_DATAFRAME_NAMES</span><span class="p">,</span>
        <span class="n">LITERAL_PANDAS_DATAFRAME_NAMES</span><span class="p">,</span>
        <span class="n">LITERAL_NUMPY_ARRAY_NAMES</span><span class="p">,</span>
        <span class="n">LITERAL_LIST_OBJECT_NAMES</span><span class="p">,</span>
        <span class="nb">str</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pd&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">psDataFrame</span><span class="p">,</span> <span class="n">pdDataFrame</span><span class="p">,</span> <span class="n">npArray</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        Extract and return unique values from a specified column of a PySpark DataFrame.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>
<span class="sd">        This function retrieves the unique values from a specified column of a PySpark DataFrame.</span>

<span class="sd">    Params:</span>
<span class="sd">        dataframe (psDataFrame):</span>
<span class="sd">            The input PySpark DataFrame.</span>
<span class="sd">        column (str):</span>
<span class="sd">            The name of the column from which to extract unique values.</span>
<span class="sd">        distinct (bool, optional):</span>
<span class="sd">            If `#!py True`, return distinct (unique) values.&lt;br&gt;</span>
<span class="sd">            Defaults to `#!py True`.</span>
<span class="sd">        return_type (Union[LITERAL_LIST_OBJECT_NAMES, LITERAL_PANDAS_DATAFRAME_NAMES, LITERAL_PYSPARK_DATAFRAME_NAMES, LITERAL_NUMPY_ARRAY_NAMES, str], optional):</span>
<span class="sd">            The desired return type.&lt;br&gt;</span>
<span class="sd">            Options:</span>

<span class="sd">            - `#!py &quot;ps&quot;`: Return the result as a PySpark DataFrame.</span>
<span class="sd">            - `#!py &quot;pd&quot;`: Return the result as a Pandas DataFrame.</span>
<span class="sd">            - `#!py &quot;np&quot;`: Return the result as a NumPy array.</span>
<span class="sd">            - `#!py &quot;list&quot;`: Return the result as a Python list.</span>

<span class="sd">            Defaults to `#!py &quot;pd&quot;`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError:</span>
<span class="sd">            If any of the inputs parsed to the parameters of this function are not the correct type. Uses the [`@typeguard.typechecked`](https://typeguard.readthedocs.io/en/stable/api.html#typeguard.typechecked) decorator.</span>
<span class="sd">        ValueError:</span>
<span class="sd">            If any of the values parsed to `return_type` are not valid options.</span>
<span class="sd">        ColumnDoesNotExistError:</span>
<span class="sd">            If the `#!py column` does not exist within `#!py dataframe.columns`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Optional[Union[psDataFrame, pdDataFrame, npArray, list]]):</span>
<span class="sd">            The values from the given column, in the desired type.</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Set up&quot;}</span>
<span class="sd">        &gt;&gt;&gt; # Imports</span>
<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; from pyspark.sql import SparkSession</span>
<span class="sd">        &gt;&gt;&gt; from toolbox_pyspark.cleaning import get_column_values</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Instantiate Spark</span>
<span class="sd">        &gt;&gt;&gt; spark = SparkSession.builder.getOrCreate()</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Create data</span>
<span class="sd">        &gt;&gt;&gt; df = spark.createDataFrame(</span>
<span class="sd">        ...     pd.DataFrame(</span>
<span class="sd">        ...         {</span>
<span class="sd">        ...             &quot;a&quot;: [0, 1, 2, 3],</span>
<span class="sd">        ...             &quot;b&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;],</span>
<span class="sd">        ...             &quot;c&quot;: [&quot;c&quot;, &quot;c&quot;, &quot;c&quot;, &quot;c&quot;],</span>
<span class="sd">        ...             &quot;d&quot;: [&quot;d&quot;, &quot;d&quot;, &quot;d&quot;, &quot;d&quot;],</span>
<span class="sd">        ...         }</span>
<span class="sd">        ...     )</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Check</span>
<span class="sd">        &gt;&gt;&gt; df.show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | a | b | c | d |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | 0 | a | c | d |</span>
<span class="sd">        | 1 | b | c | d |</span>
<span class="sd">        | 2 | c | c | d |</span>
<span class="sd">        | 3 | d | c | d |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 1: Default params&quot;}</span>
<span class="sd">        &gt;&gt;&gt; values = get_column_values(df, &quot;c&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(type(values))</span>
<span class="sd">        &gt;&gt;&gt; print(values)</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</span>
<span class="sd">        ```</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">          c</span>
<span class="sd">        0 c</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully extracted distinct values from the `c` column, and converted to Pandas.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 2: Not distinct&quot;}</span>
<span class="sd">        &gt;&gt;&gt; values = get_column_values(df, &quot;c&quot;, False)</span>
<span class="sd">        &gt;&gt;&gt; print(type(values))</span>
<span class="sd">        &gt;&gt;&gt; print(values)</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</span>
<span class="sd">        ```</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">          c</span>
<span class="sd">        0 c</span>
<span class="sd">        1 c</span>
<span class="sd">        2 c</span>
<span class="sd">        3 c</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully extracted values from the `c` column, and converted to Pandas.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 3: Flat list&quot;}</span>
<span class="sd">        &gt;&gt;&gt; values = get_column_values(df, &quot;c&quot;, False, &quot;flat_list&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(type(values))</span>
<span class="sd">        &gt;&gt;&gt; print(values)</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        &lt;class &#39;list&#39;&gt;</span>
<span class="sd">        ```</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        [&quot;c&quot;, &quot;c&quot;, &quot;c&quot;, &quot;c&quot;]</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully extracted values from the `c` column, and converted to flat List.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 4: Invalid return type&quot;}</span>
<span class="sd">        &gt;&gt;&gt; get_column_values(df, &quot;c&quot;, return_type=&quot;invalid&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        ValueError: Unknown return type: &#39;invalid&#39;.</span>
<span class="sd">        Must be one of: [&#39;pd&#39;, &#39;ps&#39;, &#39;np&#39;, &#39;list&#39;].</span>
<span class="sd">        For more info, check the `constants` module.</span>
<span class="sd">        ```</span>
<span class="sd">        !!! failure &quot;Conclusion: Invalid return type.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">    ???+ tip &quot;See Also&quot;</span>
<span class="sd">        - [`toolbox_pyspark.cleaning.convert_dataframe()`][toolbox_pyspark.cleaning.convert_dataframe]</span>
<span class="sd">        - [`toolbox_pyspark.constants`][toolbox_pyspark.constants]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">psDataFrame</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">column</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2"> is not null and </span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2"> &lt;&gt; &#39;&#39;&quot;</span>
    <span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span> <span class="k">if</span> <span class="n">distinct</span> <span class="k">else</span> <span class="n">df</span>
    <span class="k">return</span> <span class="n">convert_dataframe</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="n">return_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="toolbox_pyspark.cleaning.update_nullability" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">update_nullability</span>


<a href="#toolbox_pyspark.cleaning.update_nullability" class="headerlink" title="Permanent link">🔗</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">update_nullability</span><span class="p">(</span>
    <span class="n">dataframe</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">str_collection</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">nullable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>Update the nullability of specified columns in a PySpark DataFrame.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>This function updates the nullability of the specified columns in a PySpark DataFrame. If no columns are specified, it updates the nullability of all columns.</p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataframe</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input PySpark DataFrame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[str, <span title="toolbox_python.collection_types.str_collection">str_collection</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The columns for which to update nullability. If not provided, all columns will be updated.<br>
Defaults to <code class="highlight"><span class="kc">None</span></code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nullable</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to set the columns as nullable or not.<br>
Defaults to <code class="highlight"><span class="kc">True</span></code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>TypeError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any of the inputs parsed to the parameters of this function are not the correct type. Uses the <a href="https://typeguard.readthedocs.io/en/stable/api.html#typeguard.typechecked"><code>@typeguard.typechecked</code></a> decorator.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ColumnDoesNotExistError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any of the <code class="highlight"><span class="n">columns</span></code> do not exist within <code class="highlight"><span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span></code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The updated DataFrame with the specified columns' nullability updated.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Set up</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Imports</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">toolbox_pyspark.cleaning</span> <span class="kn">import</span> <span class="n">update_nullability</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Instantiate Spark</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="o">...</span>         <span class="p">{</span>
<span class="o">...</span>             <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">3.3</span><span class="p">,</span> <span class="mf">4.4</span><span class="p">],</span>
<span class="o">...</span>         <span class="p">}</span>
<span class="o">...</span>     <span class="p">)</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Check</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">schema</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+-----+
| a | b |   c |
+---+---+-----+
| 1 | a | 1.1 |
| 2 | b | 2.2 |
| 3 | c | 3.3 |
| 4 | d | 4.4 |
+---+---+-----+
</code></pre></div>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>StructType(
    [
        StructField(&quot;a&quot;, LongType(), True),
        StructField(&quot;b&quot;, StringType(), True),
        StructField(&quot;c&quot;, DoubleType(), True),
    ]
)
</code></pre></div>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>root
 |-- a: long (nullable = true)
 |-- b: string (nullable = true)
 |-- c: double (nullable = true)
</code></pre></div>
</div></p>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Update nullability of all columns</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">new_df</span> <span class="o">=</span> <span class="n">update_nullability</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">new_df</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>root
 |-- a: long (nullable = false)
 |-- b: string (nullable = false)
 |-- c: double (nullable = false)
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully updated nullability of all columns.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Update nullability of specific columns</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">new_df</span> <span class="o">=</span> <span class="n">update_nullability</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">new_df</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>root
 |-- a: long (nullable = false)
 |-- b: string (nullable = true)
 |-- c: double (nullable = false)
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully updated nullability of specific columns.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: Column does not exist</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">update_nullability</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>ColumnDoesNotExistError: Column &#39;d&#39; does not exist in the DataFrame.
Try one of: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]
</code></pre></div></p>
<div class="admonition failure">
<p class="admonition-title">Conclusion: Column does not exist.</p>
</div>
</div>
</details>
<details class="success">
<summary>Credit</summary>
<p>All credit goes to: <a href="https://stackoverflow.com/questions/46072411/can-i-change-the-nullability-of-a-column-in-my-spark-dataframe#answer-51821437">https://stackoverflow.com/questions/46072411/can-i-change-the-nullability-of-a-column-in-my-spark-dataframe#answer-51821437</a>.</p>
</details>
<details class="tip" open="open">
<summary>See Also</summary>
<ul>
<li><a class="autorefs autorefs-internal" href="../checks/#toolbox_pyspark.checks.assert_columns_exists"><code>toolbox_pyspark.checks.assert_columns_exists()</code></a></li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>src/toolbox_pyspark/cleaning.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span> <span class="nf">update_nullability</span><span class="p">(</span>
    <span class="n">dataframe</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">str_collection</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">nullable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        Update the nullability of specified columns in a PySpark DataFrame.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>
<span class="sd">        This function updates the nullability of the specified columns in a PySpark DataFrame. If no columns are specified, it updates the nullability of all columns.</span>

<span class="sd">    Params:</span>
<span class="sd">        dataframe (psDataFrame):</span>
<span class="sd">            The input PySpark DataFrame.</span>
<span class="sd">        columns (Optional[Union[str, str_collection]], optional):</span>
<span class="sd">            The columns for which to update nullability. If not provided, all columns will be updated.&lt;br&gt;</span>
<span class="sd">            Defaults to `#!py None`.</span>
<span class="sd">        nullable (bool, optional):</span>
<span class="sd">            Whether to set the columns as nullable or not.&lt;br&gt;</span>
<span class="sd">            Defaults to `#!py True`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError:</span>
<span class="sd">            If any of the inputs parsed to the parameters of this function are not the correct type. Uses the [`@typeguard.typechecked`](https://typeguard.readthedocs.io/en/stable/api.html#typeguard.typechecked) decorator.</span>
<span class="sd">        ColumnDoesNotExistError:</span>
<span class="sd">            If any of the `#!py columns` do not exist within `#!py dataframe.columns`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (psDataFrame):</span>
<span class="sd">            The updated DataFrame with the specified columns&#39; nullability updated.</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Set up&quot;}</span>
<span class="sd">        &gt;&gt;&gt; # Imports</span>
<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; from pyspark.sql import SparkSession</span>
<span class="sd">        &gt;&gt;&gt; from toolbox_pyspark.cleaning import update_nullability</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Instantiate Spark</span>
<span class="sd">        &gt;&gt;&gt; spark = SparkSession.builder.getOrCreate()</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Create data</span>
<span class="sd">        &gt;&gt;&gt; df = spark.createDataFrame(</span>
<span class="sd">        ...     pd.DataFrame(</span>
<span class="sd">        ...         {</span>
<span class="sd">        ...             &quot;a&quot;: [1, 2, 3, 4],</span>
<span class="sd">        ...             &quot;b&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;],</span>
<span class="sd">        ...             &quot;c&quot;: [1.1, 2.2, 3.3, 4.4],</span>
<span class="sd">        ...         }</span>
<span class="sd">        ...     )</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Check</span>
<span class="sd">        &gt;&gt;&gt; df.show()</span>
<span class="sd">        &gt;&gt;&gt; print(df.schema)</span>
<span class="sd">        &gt;&gt;&gt; df.printSchema()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+-----+</span>
<span class="sd">        | a | b |   c |</span>
<span class="sd">        +---+---+-----+</span>
<span class="sd">        | 1 | a | 1.1 |</span>
<span class="sd">        | 2 | b | 2.2 |</span>
<span class="sd">        | 3 | c | 3.3 |</span>
<span class="sd">        | 4 | d | 4.4 |</span>
<span class="sd">        +---+---+-----+</span>
<span class="sd">        ```</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        StructType(</span>
<span class="sd">            [</span>
<span class="sd">                StructField(&quot;a&quot;, LongType(), True),</span>
<span class="sd">                StructField(&quot;b&quot;, StringType(), True),</span>
<span class="sd">                StructField(&quot;c&quot;, DoubleType(), True),</span>
<span class="sd">            ]</span>
<span class="sd">        )</span>
<span class="sd">        ```</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        root</span>
<span class="sd">         |-- a: long (nullable = true)</span>
<span class="sd">         |-- b: string (nullable = true)</span>
<span class="sd">         |-- c: double (nullable = true)</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 1: Update nullability of all columns&quot;}</span>
<span class="sd">        &gt;&gt;&gt; new_df = update_nullability(df, nullable=False)</span>
<span class="sd">        &gt;&gt;&gt; new_df.printSchema()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        root</span>
<span class="sd">         |-- a: long (nullable = false)</span>
<span class="sd">         |-- b: string (nullable = false)</span>
<span class="sd">         |-- c: double (nullable = false)</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully updated nullability of all columns.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 2: Update nullability of specific columns&quot;}</span>
<span class="sd">        &gt;&gt;&gt; new_df = update_nullability(df, columns=[&quot;a&quot;, &quot;c&quot;], nullable=False)</span>
<span class="sd">        &gt;&gt;&gt; new_df.printSchema()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        root</span>
<span class="sd">         |-- a: long (nullable = false)</span>
<span class="sd">         |-- b: string (nullable = true)</span>
<span class="sd">         |-- c: double (nullable = false)</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully updated nullability of specific columns.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 3: Column does not exist&quot;}</span>
<span class="sd">        &gt;&gt;&gt; update_nullability(df, columns=&quot;d&quot;, nullable=False)</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        ColumnDoesNotExistError: Column &#39;d&#39; does not exist in the DataFrame.</span>
<span class="sd">        Try one of: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</span>
<span class="sd">        ```</span>
<span class="sd">        !!! failure &quot;Conclusion: Column does not exist.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">    ??? success &quot;Credit&quot;</span>
<span class="sd">        All credit goes to: https://stackoverflow.com/questions/46072411/can-i-change-the-nullability-of-a-column-in-my-spark-dataframe#answer-51821437.</span>

<span class="sd">    ???+ tip &quot;See Also&quot;</span>
<span class="sd">        - [`toolbox_pyspark.checks.assert_columns_exists()`][toolbox_pyspark.checks.assert_columns_exists]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="n">get_columns</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span>
    <span class="n">assert_columns_exists</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">schema</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">StructType</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">schema</span>
    <span class="k">for</span> <span class="n">struct_field</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">struct_field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">struct_field</span><span class="o">.</span><span class="n">nullable</span> <span class="o">=</span> <span class="n">nullable</span>
    <span class="k">return</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">sparkSession</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">dataframe</span><span class="o">.</span><span class="n">rdd</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">dataframe</span><span class="o">.</span><span class="n">schema</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="toolbox_pyspark.cleaning.trim_spaces_from_column" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">trim_spaces_from_column</span>


<a href="#toolbox_pyspark.cleaning.trim_spaces_from_column" class="headerlink" title="Permanent link">🔗</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">trim_spaces_from_column</span><span class="p">(</span>
    <span class="n">dataframe</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>For a given list of columns, trim all of the excess white spaces from them.</p>
</div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataframe</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame to update.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>column</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The column to clean.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>TypeError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any of the inputs parsed to the parameters of this function are not the correct type. Uses the <a href="https://typeguard.readthedocs.io/en/stable/api.html#typeguard.typechecked"><code>@typeguard.typechecked</code></a> decorator.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ColumnDoesNotExistError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the <code class="highlight"><span class="n">column</span></code> does not exist within <code class="highlight"><span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span></code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The updated Data Frame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Set up</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Imports</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">toolbox_pyspark.cleaning</span> <span class="kn">import</span> <span class="n">trim_spaces_from_column</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Instantiate Spark</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="o">...</span>         <span class="p">{</span>
<span class="o">...</span>             <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1   &quot;</span><span class="p">,</span> <span class="s2">&quot;1   &quot;</span><span class="p">,</span> <span class="s2">&quot;1   &quot;</span><span class="p">,</span> <span class="s2">&quot;1   &quot;</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;   2&quot;</span><span class="p">,</span> <span class="s2">&quot;   2&quot;</span><span class="p">,</span> <span class="s2">&quot;   2&quot;</span><span class="p">,</span> <span class="s2">&quot;   2&quot;</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;e&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;   3   &quot;</span><span class="p">,</span> <span class="s2">&quot;   3   &quot;</span><span class="p">,</span> <span class="s2">&quot;   3   &quot;</span><span class="p">,</span> <span class="s2">&quot;   3   &quot;</span><span class="p">],</span>
<span class="o">...</span>         <span class="p">}</span>
<span class="o">...</span>     <span class="p">)</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Check</span>
<span class="err">```</span><span class="p">{</span><span class="o">.</span><span class="n">py</span> <span class="o">.</span><span class="n">python</span> <span class="n">linenums</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Check&quot;</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+------+------+---------+
| a | b |    c |    d |       e |
+---+---+------+------+---------+
| 1 | a | 1    |    2 |    3    |
| 2 | b | 1    |    2 |    3    |
| 3 | c | 1    |    2 |    3    |
| 4 | d | 1    |    2 |    3    |
+---+---+------+------+---------+
</code></pre></div>
</div></p>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Trim column</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">trim_spaces_from_column</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+------+--------+
| a | b | c |    d |      e |
+---+---+---+------+--------+
| 1 | a | 1 |    2 |   2    |
| 2 | b | 1 |    2 |   2    |
| 3 | c | 1 |    2 |   2    |
| 4 | d | 1 |    2 |   2    |
+---+---+---+------+--------+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully trimmed the <code>c</code> column.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Invalid column</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">trim_spaces_from_column</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>ColumnDoesNotExistError: Column &#39;f&#39; does not exist in the DataFrame.
Try one of: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;]
</code></pre></div></p>
<div class="admonition failure">
<p class="admonition-title">Conclusion: Column does not exist.</p>
</div>
</div>
</details>
<details class="info">
<summary>Notes</summary>
<details class="info" open="open">
<summary>Justification</summary>
<ul>
<li>The main reason for this function is because when the data was exported from the Legacy WMS's, there's a <em>whole bunch</em> of trailing spaces in the data fields. My theory is because of the data type in the source system. That is, if it's originally stored as 'char' type, then it will maintain the data length. This issues doesn't seem to be affecting the <code>varchar</code> fields. Nonetheless, this function will strip the white spaces from the data; thus reducing the total size of the data stored therein.</li>
<li>The reason why it is necessary to write this out as a custom function, instead of using the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.trim.html"><code>F.trim()</code></a> function from the PySpark library directly is due to the deficiencies of the Java <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#trim"><code>trim()</code></a> function. More specifically, there are 13 different whitespace characters available in our ascii character set. The Java function only cleans about 6 of these. So therefore, we define this function which iterates through all 13 whitespace characters, and formats them in to a regular expression, to then parse it to the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.regexp_replace.html"><code>F.regexp_replace()</code></a> function to be replaced with an empty string (<code>""</code>). Therefore, all 13 characters will be replaced, the strings will be cleaned and trimmed ready for further processing.</li>
</ul>
</details>
<details class="info" open="open">
<summary>Regex definition: <code>^[...]+|[...]+$</code></summary>
<ul>
<li>1st Alternative: '^[...]+'<ul>
<li>'^' asserts position at start of a line</li>
<li>Match a single character present in the list below '[...]'<ul>
<li>'+' matches the previous token between one and unlimited times, as many times as possible, giving back as needed (greedy)</li>
<li>matches a single character in the list '  ' (case sensitive)<ul>
<li>matches the character ' ' with index 160 (A0 or 240) literally (case sensitive)</li>
<li>matches the character ' ' with index 32 (20 or 40) literally (case sensitive)</li>
<li>... (repeat for all whitespace characters)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>2nd Alternative: '[...]+$'<ul>
<li>Match a single character present in the list below '[...]'<ul>
<li>'+' matches the previous token between one and unlimited times, as many times as possible, giving back as needed (greedy)</li>
<li>matches a single character in the list '  ' (case sensitive)<ul>
<li>matches the character ' ' with index 160 (A0 or 240) literally (case sensitive)</li>
<li>matches the character ' ' with index 32 (20 or 40) literally (case sensitive)</li>
<li>... (repeat for all whitespace characters)</li>
</ul>
</li>
</ul>
</li>
<li>'$' asserts position at the end of a line</li>
</ul>
</li>
</ul>
</details>
</details>
<details class="tip">
<summary>See Also</summary>
<ul>
<li><a class="autorefs autorefs-internal" href="#toolbox_pyspark.cleaning.trim_spaces_from_columns"><code>trim_spaces_from_columns()</code></a></li>
<li><a class="autorefs autorefs-internal" href="../constants/#toolbox_pyspark.constants.ALL_WHITESPACE_CHARACTERS"><code>ALL_WHITESPACE_CHARACTERS</code></a></li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>src/toolbox_pyspark/cleaning.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span> <span class="nf">trim_spaces_from_column</span><span class="p">(</span>
    <span class="n">dataframe</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        For a given list of columns, trim all of the excess white spaces from them.</span>

<span class="sd">    Params:</span>
<span class="sd">        dataframe (psDataFrame):</span>
<span class="sd">            The DataFrame to update.</span>
<span class="sd">        column (str):</span>
<span class="sd">            The column to clean.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError:</span>
<span class="sd">            If any of the inputs parsed to the parameters of this function are not the correct type. Uses the [`@typeguard.typechecked`](https://typeguard.readthedocs.io/en/stable/api.html#typeguard.typechecked) decorator.</span>
<span class="sd">        ColumnDoesNotExistError:</span>
<span class="sd">            If the `#!py column` does not exist within `#!py dataframe.columns`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (psDataFrame):</span>
<span class="sd">            The updated Data Frame.</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Set up&quot;}</span>
<span class="sd">        &gt;&gt;&gt; # Imports</span>
<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; from pyspark.sql import SparkSession</span>
<span class="sd">        &gt;&gt;&gt; from toolbox_pyspark.cleaning import trim_spaces_from_column</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Instantiate Spark</span>
<span class="sd">        &gt;&gt;&gt; spark = SparkSession.builder.getOrCreate()</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Create data</span>
<span class="sd">        &gt;&gt;&gt; df = spark.createDataFrame(</span>
<span class="sd">        ...     pd.DataFrame(</span>
<span class="sd">        ...         {</span>
<span class="sd">        ...             &quot;a&quot;: [1, 2, 3, 4],</span>
<span class="sd">        ...             &quot;b&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;],</span>
<span class="sd">        ...             &quot;c&quot;: [&quot;1   &quot;, &quot;1   &quot;, &quot;1   &quot;, &quot;1   &quot;],</span>
<span class="sd">        ...             &quot;d&quot;: [&quot;   2&quot;, &quot;   2&quot;, &quot;   2&quot;, &quot;   2&quot;],</span>
<span class="sd">        ...             &quot;e&quot;: [&quot;   3   &quot;, &quot;   3   &quot;, &quot;   3   &quot;, &quot;   3   &quot;],</span>
<span class="sd">        ...         }</span>
<span class="sd">        ...     )</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Check</span>
<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Check&quot;}</span>
<span class="sd">        &gt;&gt;&gt; df.show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+------+------+---------+</span>
<span class="sd">        | a | b |    c |    d |       e |</span>
<span class="sd">        +---+---+------+------+---------+</span>
<span class="sd">        | 1 | a | 1    |    2 |    3    |</span>
<span class="sd">        | 2 | b | 1    |    2 |    3    |</span>
<span class="sd">        | 3 | c | 1    |    2 |    3    |</span>
<span class="sd">        | 4 | d | 1    |    2 |    3    |</span>
<span class="sd">        +---+---+------+------+---------+</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 1: Trim column&quot;}</span>
<span class="sd">        &gt;&gt;&gt; trim_spaces_from_column(df, &quot;c&quot;).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+------+--------+</span>
<span class="sd">        | a | b | c |    d |      e |</span>
<span class="sd">        +---+---+---+------+--------+</span>
<span class="sd">        | 1 | a | 1 |    2 |   2    |</span>
<span class="sd">        | 2 | b | 1 |    2 |   2    |</span>
<span class="sd">        | 3 | c | 1 |    2 |   2    |</span>
<span class="sd">        | 4 | d | 1 |    2 |   2    |</span>
<span class="sd">        +---+---+---+------+--------+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully trimmed the `c` column.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 2: Invalid column&quot;}</span>
<span class="sd">        &gt;&gt;&gt; trim_spaces_from_column(df, &quot;f&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        ColumnDoesNotExistError: Column &#39;f&#39; does not exist in the DataFrame.</span>
<span class="sd">        Try one of: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;]</span>
<span class="sd">        ```</span>
<span class="sd">        !!! failure &quot;Conclusion: Column does not exist.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">    ??? info &quot;Notes&quot;</span>

<span class="sd">        ???+ info &quot;Justification&quot;</span>
<span class="sd">            - The main reason for this function is because when the data was exported from the Legacy WMS&#39;s, there&#39;s a _whole bunch_ of trailing spaces in the data fields. My theory is because of the data type in the source system. That is, if it&#39;s originally stored as &#39;char&#39; type, then it will maintain the data length. This issues doesn&#39;t seem to be affecting the `varchar` fields. Nonetheless, this function will strip the white spaces from the data; thus reducing the total size of the data stored therein.</span>
<span class="sd">            - The reason why it is necessary to write this out as a custom function, instead of using the [`F.trim()`][trim] function from the PySpark library directly is due to the deficiencies of the Java [`trim()`](https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#trim) function. More specifically, there are 13 different whitespace characters available in our ascii character set. The Java function only cleans about 6 of these. So therefore, we define this function which iterates through all 13 whitespace characters, and formats them in to a regular expression, to then parse it to the [`F.regexp_replace()`][regexp_replace] function to be replaced with an empty string (`&quot;&quot;`). Therefore, all 13 characters will be replaced, the strings will be cleaned and trimmed ready for further processing.</span>

<span class="sd">            [trim]: https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.trim.html</span>
<span class="sd">            [regexp_replace]: https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.regexp_replace.html</span>

<span class="sd">        ???+ info &quot;Regex definition: `^[...]+|[...]+$`&quot;</span>
<span class="sd">            - 1st Alternative: &#39;^[...]+&#39;</span>
<span class="sd">                - &#39;^&#39; asserts position at start of a line</span>
<span class="sd">                - Match a single character present in the list below &#39;[...]&#39;</span>
<span class="sd">                    - &#39;+&#39; matches the previous token between one and unlimited times, as many times as possible, giving back as needed (greedy)</span>
<span class="sd">                    - matches a single character in the list &#39;  &#39; (case sensitive)</span>
<span class="sd">                        - matches the character &#39; &#39; with index 160 (A0 or 240) literally (case sensitive)</span>
<span class="sd">                        - matches the character &#39; &#39; with index 32 (20 or 40) literally (case sensitive)</span>
<span class="sd">                        - ... (repeat for all whitespace characters)</span>
<span class="sd">            - 2nd Alternative: &#39;[...]+$&#39;</span>
<span class="sd">                - Match a single character present in the list below &#39;[...]&#39;</span>
<span class="sd">                    - &#39;+&#39; matches the previous token between one and unlimited times, as many times as possible, giving back as needed (greedy)</span>
<span class="sd">                    - matches a single character in the list &#39;  &#39; (case sensitive)</span>
<span class="sd">                        - matches the character &#39; &#39; with index 160 (A0 or 240) literally (case sensitive)</span>
<span class="sd">                        - matches the character &#39; &#39; with index 32 (20 or 40) literally (case sensitive)</span>
<span class="sd">                        - ... (repeat for all whitespace characters)</span>
<span class="sd">                - &#39;$&#39; asserts position at the end of a line</span>

<span class="sd">    ??? tip &quot;See Also&quot;</span>
<span class="sd">        - [`trim_spaces_from_columns()`][toolbox_pyspark.cleaning.trim_spaces_from_columns]</span>
<span class="sd">        - [`ALL_WHITESPACE_CHARACTERS`][toolbox_pyspark.constants.ALL_WHITESPACE_CHARACTERS]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">assert_column_exists</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">match_case</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">space_chars</span><span class="p">:</span> <span class="n">str_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">chr</span><span class="p">(</span><span class="n">char</span><span class="o">.</span><span class="n">ascii</span><span class="p">)</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">WHITESPACES</span><span class="p">]</span>
    <span class="n">regexp</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;^[</span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">space_chars</span><span class="p">)</span><span class="si">}</span><span class="s2">]+|[</span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">space_chars</span><span class="p">)</span><span class="si">}</span><span class="s2">]+$&quot;</span>
    <span class="k">return</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">regexp_replace</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">regexp</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="toolbox_pyspark.cleaning.trim_spaces_from_columns" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">trim_spaces_from_columns</span>


<a href="#toolbox_pyspark.cleaning.trim_spaces_from_columns" class="headerlink" title="Permanent link">🔗</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">trim_spaces_from_columns</span><span class="p">(</span>
    <span class="n">dataframe</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">str_collection</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>For a given list of columns, trim all of the excess white spaces from them.</p>
</div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataframe</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame to be updated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[str, <span title="toolbox_python.collection_types.str_collection">str_collection</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of columns to be updated.
Must be valid columns on <code>dataframe</code>.
If given as a string, will be executed as a single column (ie. one-element long list).
If not given, will apply to all columns in <code>dataframe</code> which have the data-type <code>string</code>.
It is also possible to parse the values <code class="highlight"><span class="s2">&quot;all&quot;</span></code> or <code class="highlight"><span class="s2">&quot;all_string&quot;</span></code>, which will also apply this function to all columns in <code>dataframe</code> which have the data-type <code>string</code>.<br>
Defaults to <code class="highlight"><span class="kc">None</span></code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The updated DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Set up</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Imports</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">toolbox_pyspark.cleaning</span> <span class="kn">import</span> <span class="n">trim_spaces_from_columns</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Instantiate Spark</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="o">...</span>         <span class="p">{</span>
<span class="o">...</span>             <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1   &quot;</span><span class="p">,</span> <span class="s2">&quot;1   &quot;</span><span class="p">,</span> <span class="s2">&quot;1   &quot;</span><span class="p">,</span> <span class="s2">&quot;1   &quot;</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;   2&quot;</span><span class="p">,</span> <span class="s2">&quot;   2&quot;</span><span class="p">,</span> <span class="s2">&quot;   2&quot;</span><span class="p">,</span> <span class="s2">&quot;   2&quot;</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;e&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;   3   &quot;</span><span class="p">,</span> <span class="s2">&quot;   3   &quot;</span><span class="p">,</span> <span class="s2">&quot;   3   &quot;</span><span class="p">,</span> <span class="s2">&quot;   3   &quot;</span><span class="p">],</span>
<span class="o">...</span>         <span class="p">}</span>
<span class="o">...</span>     <span class="p">)</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Check</span>
<span class="err">```</span><span class="p">{</span><span class="o">.</span><span class="n">py</span> <span class="o">.</span><span class="n">python</span> <span class="n">linenums</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Check&quot;</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+------+------+---------+
| a | b |    c |    d |       e |
+---+---+------+------+---------+
| 1 | a | 1    |    2 |    3    |
| 2 | b | 1    |    2 |    3    |
| 3 | c | 1    |    2 |    3    |
| 4 | d | 1    |    2 |    3    |
+---+---+------+------+---------+
</code></pre></div>
</div></p>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: One column as list</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">trim_spaces_from_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+------+---------+
| a | b | c |    d |       e |
+---+---+---+------+---------+
| 1 | a | 1 |    2 |    3    |
| 2 | b | 1 |    2 |    3    |
| 3 | c | 1 |    2 |    3    |
| 4 | d | 1 |    2 |    3    |
+---+---+---+------+---------+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully trimmed the <code>c</code> column.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Single column as string</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">trim_spaces_from_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+------+---+---------+
| a | b |    c | d |       e |
+---+---+------+---+---------+
| 1 | a | 1    | 2 |    3    |
| 2 | b | 1    | 2 |    3    |
| 3 | c | 1    | 2 |    3    |
| 4 | d | 1    | 2 |    3    |
+---+---+------+---+---------+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully trimmed the <code>d</code> column.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: Multiple columns</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">trim_spaces_from_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+---------+
| a | b | c | d |       e |
+---+---+---+---+---------+
| 1 | a | 1 | 2 |    3    |
| 2 | b | 1 | 2 |    3    |
| 3 | c | 1 | 2 |    3    |
| 4 | d | 1 | 2 |    3    |
+---+---+---+---+---------+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully trimmed the <code>c</code> and <code>d</code> columns.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 4: All columns</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">trim_spaces_from_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+---+
| a | b | c | d | e |
+---+---+---+---+---+
| 1 | a | 1 | 2 | 3 |
| 2 | b | 1 | 2 | 3 |
| 3 | c | 1 | 2 | 3 |
| 4 | d | 1 | 2 | 3 |
+---+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully trimmed all columns.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 5: Default config</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">trim_spaces_from_columns</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+---+
| a | b | c | d | e |
+---+---+---+---+---+
| 1 | a | 1 | 2 | 3 |
| 2 | b | 1 | 2 | 3 |
| 3 | c | 1 | 2 | 3 |
| 4 | d | 1 | 2 | 3 |
+---+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully trimmed all columns.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 6: Invalid column</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">trim_spaces_from_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>ColumnDoesNotExistError: Columns [&#39;f&#39;] do not exist in the DataFrame.
Try one of: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;]
</code></pre></div></p>
<div class="admonition failure">
<p class="admonition-title">Conclusion: Columns do not exist.</p>
</div>
</div>
</details>
<details class="info" open="open">
<summary>Notes</summary>
<details class="info" open="open">
<summary>Justification</summary>
<ul>
<li>The main reason for this function is because when the data was exported from the Legacy WMS's, there's a <em>whole bunch</em> of trailing spaces in the data fields. My theory is because of the data type in the source system. That is, if it's originally stored as 'char' type, then it will maintain the data length. This issues doesn't seem to be affecting the <code>varchar</code> fields. Nonetheless, this function will strip the white spaces from the data; thus reducing the total size of the data stored therein.</li>
<li>The reason why it is necessary to write this out as a custom function, instead of using the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.trim.html"><code>F.trim()</code></a> function from the PySpark library directly is due to the deficiencies of the Java <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#trim"><code>trim()</code></a> function. More specifically, there are 13 different whitespace characters available in our ascii character set. The Java function only cleans about 6 of these. So therefore, we define this function which iterates through all 13 whitespace characters, and formats them in to a regular expression, to then parse it to the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.regexp_replace.html"><code>F.regexp_replace()</code></a> function to be replaced with an empty string (<code>""</code>). Therefore, all 13 characters will be replaced, the strings will be cleaned and trimmed ready for further processing.</li>
<li>The reason why this function exists as a standalone, and does not call <a class="autorefs autorefs-internal" href="#toolbox_pyspark.cleaning.trim_spaces_from_column"><code>trim_spaces_from_column()</code></a> from within a loop is because <a class="autorefs autorefs-internal" href="#toolbox_pyspark.cleaning.trim_spaces_from_column"><code>trim_spaces_from_column()</code></a> utilises the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.withColumn.html"><code>.withColumn()</code></a> method to implement the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.regexp_replace.html"><code>F.regexp_replace()</code></a> function on columns individually. When implemented iteratively, this process will create huge DAG's for the RDD, and blow out the complexity to a huge extend. Whereas this <a class="autorefs autorefs-internal" href="#toolbox_pyspark.cleaning.trim_spaces_from_columns"><code>trim_spaces_from_columns()</code></a> function will utilise the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.withColumns.html"><code>.withColumns()</code></a> method to implement the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.regexp_replace.html"><code>F.regexp_replace()</code></a> function over all columns at once. This <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.withColumns.html"><code>.withColumns()</code></a> method projects the function down to the underlying dataset in one single execution; not a different execution per column. Therefore, it is more simpler and more efficient.</li>
</ul>
</details>
<details class="info" open="open">
<summary>Regex definition: <code>^[...]+|[...]+$</code></summary>
<ul>
<li>1st Alternative: <code>^[...]+</code><ul>
<li><code>^</code> asserts position at start of a line</li>
<li>Match a single character present in the list below <code>[...]</code><ul>
<li><code>+</code> matches the previous token between one and unlimited times, as many times as possible, giving back as needed (greedy)</li>
<li>matches a single character in the list <code></code> (case sensitive)<ul>
<li>matches the character <code></code> with index 160 (A0 or 240) literally (case sensitive)</li>
<li>matches the character <code></code> with index 32 (20 or 40) literally (case sensitive)</li>
<li>... (repeat for all whitespace characters)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>2nd Alternative: <code>[...]+$</code><ul>
<li>Match a single character present in the list below <code>[...]</code><ul>
<li><code>+</code> matches the previous token between one and unlimited times, as many times as possible, giving back as needed (greedy)</li>
<li>matches a single character in the list <code></code> (case sensitive)<ul>
<li>matches the character <code></code> with index 160 (A0 or 240) literally (case sensitive)</li>
<li>matches the character <code></code> with index 32 (20 or 40) literally (case sensitive)</li>
<li>... (repeat for all whitespace characters)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</details>
</details>
<details class="tip">
<summary>See Also</summary>
<ul>
<li><a class="autorefs autorefs-internal" href="#toolbox_pyspark.cleaning.trim_spaces_from_column"><code>trim_spaces_from_column()</code></a></li>
<li><a class="autorefs autorefs-internal" href="../constants/#toolbox_pyspark.constants.ALL_WHITESPACE_CHARACTERS"><code>ALL_WHITESPACE_CHARACTERS</code></a></li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>src/toolbox_pyspark/cleaning.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span> <span class="nf">trim_spaces_from_columns</span><span class="p">(</span>
    <span class="n">dataframe</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">str_collection</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        For a given list of columns, trim all of the excess white spaces from them.</span>

<span class="sd">    Params:</span>
<span class="sd">        dataframe (psDataFrame):</span>
<span class="sd">            The DataFrame to be updated.</span>
<span class="sd">        columns (Optional[Union[str, str_collection]], optional):</span>
<span class="sd">            The list of columns to be updated.</span>
<span class="sd">            Must be valid columns on `dataframe`.</span>
<span class="sd">            If given as a string, will be executed as a single column (ie. one-element long list).</span>
<span class="sd">            If not given, will apply to all columns in `dataframe` which have the data-type `string`.</span>
<span class="sd">            It is also possible to parse the values `#!py &quot;all&quot;` or `#!py &quot;all_string&quot;`, which will also apply this function to all columns in `dataframe` which have the data-type `string`.&lt;br&gt;</span>
<span class="sd">            Defaults to `#!py None`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (psDataFrame):</span>
<span class="sd">            The updated DataFrame.</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Set up&quot;}</span>
<span class="sd">        &gt;&gt;&gt; # Imports</span>
<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; from pyspark.sql import SparkSession</span>
<span class="sd">        &gt;&gt;&gt; from toolbox_pyspark.cleaning import trim_spaces_from_columns</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Instantiate Spark</span>
<span class="sd">        &gt;&gt;&gt; spark = SparkSession.builder.getOrCreate()</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Create data</span>
<span class="sd">        &gt;&gt;&gt; df = spark.createDataFrame(</span>
<span class="sd">        ...     pd.DataFrame(</span>
<span class="sd">        ...         {</span>
<span class="sd">        ...             &quot;a&quot;: [1, 2, 3, 4],</span>
<span class="sd">        ...             &quot;b&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;],</span>
<span class="sd">        ...             &quot;c&quot;: [&quot;1   &quot;, &quot;1   &quot;, &quot;1   &quot;, &quot;1   &quot;],</span>
<span class="sd">        ...             &quot;d&quot;: [&quot;   2&quot;, &quot;   2&quot;, &quot;   2&quot;, &quot;   2&quot;],</span>
<span class="sd">        ...             &quot;e&quot;: [&quot;   3   &quot;, &quot;   3   &quot;, &quot;   3   &quot;, &quot;   3   &quot;],</span>
<span class="sd">        ...         }</span>
<span class="sd">        ...     )</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Check</span>
<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Check&quot;}</span>
<span class="sd">        &gt;&gt;&gt; df.show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+------+------+---------+</span>
<span class="sd">        | a | b |    c |    d |       e |</span>
<span class="sd">        +---+---+------+------+---------+</span>
<span class="sd">        | 1 | a | 1    |    2 |    3    |</span>
<span class="sd">        | 2 | b | 1    |    2 |    3    |</span>
<span class="sd">        | 3 | c | 1    |    2 |    3    |</span>
<span class="sd">        | 4 | d | 1    |    2 |    3    |</span>
<span class="sd">        +---+---+------+------+---------+</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 1: One column as list&quot;}</span>
<span class="sd">        &gt;&gt;&gt; trim_spaces_from_columns(df, [&quot;c&quot;]).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+------+---------+</span>
<span class="sd">        | a | b | c |    d |       e |</span>
<span class="sd">        +---+---+---+------+---------+</span>
<span class="sd">        | 1 | a | 1 |    2 |    3    |</span>
<span class="sd">        | 2 | b | 1 |    2 |    3    |</span>
<span class="sd">        | 3 | c | 1 |    2 |    3    |</span>
<span class="sd">        | 4 | d | 1 |    2 |    3    |</span>
<span class="sd">        +---+---+---+------+---------+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully trimmed the `c` column.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 2: Single column as string&quot;}</span>
<span class="sd">        &gt;&gt;&gt; trim_spaces_from_columns(df, &quot;d&quot;).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+------+---+---------+</span>
<span class="sd">        | a | b |    c | d |       e |</span>
<span class="sd">        +---+---+------+---+---------+</span>
<span class="sd">        | 1 | a | 1    | 2 |    3    |</span>
<span class="sd">        | 2 | b | 1    | 2 |    3    |</span>
<span class="sd">        | 3 | c | 1    | 2 |    3    |</span>
<span class="sd">        | 4 | d | 1    | 2 |    3    |</span>
<span class="sd">        +---+---+------+---+---------+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully trimmed the `d` column.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 3: Multiple columns&quot;}</span>
<span class="sd">        &gt;&gt;&gt; trim_spaces_from_columns(df, [&quot;c&quot;, &quot;d&quot;]).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+---------+</span>
<span class="sd">        | a | b | c | d |       e |</span>
<span class="sd">        +---+---+---+---+---------+</span>
<span class="sd">        | 1 | a | 1 | 2 |    3    |</span>
<span class="sd">        | 2 | b | 1 | 2 |    3    |</span>
<span class="sd">        | 3 | c | 1 | 2 |    3    |</span>
<span class="sd">        | 4 | d | 1 | 2 |    3    |</span>
<span class="sd">        +---+---+---+---+---------+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully trimmed the `c` and `d` columns.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 4: All columns&quot;}</span>
<span class="sd">        &gt;&gt;&gt; trim_spaces_from_columns(df, &quot;all&quot;).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | a | b | c | d | e |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | 1 | a | 1 | 2 | 3 |</span>
<span class="sd">        | 2 | b | 1 | 2 | 3 |</span>
<span class="sd">        | 3 | c | 1 | 2 | 3 |</span>
<span class="sd">        | 4 | d | 1 | 2 | 3 |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully trimmed all columns.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 5: Default config&quot;}</span>
<span class="sd">        &gt;&gt;&gt; trim_spaces_from_columns(df).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | a | b | c | d | e |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | 1 | a | 1 | 2 | 3 |</span>
<span class="sd">        | 2 | b | 1 | 2 | 3 |</span>
<span class="sd">        | 3 | c | 1 | 2 | 3 |</span>
<span class="sd">        | 4 | d | 1 | 2 | 3 |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully trimmed all columns.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 6: Invalid column&quot;}</span>
<span class="sd">        &gt;&gt;&gt; trim_spaces_from_columns(df, [&quot;f&quot;])</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        ColumnDoesNotExistError: Columns [&#39;f&#39;] do not exist in the DataFrame.</span>
<span class="sd">        Try one of: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;]</span>
<span class="sd">        ```</span>
<span class="sd">        !!! failure &quot;Conclusion: Columns do not exist.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">    ???+ info &quot;Notes&quot;</span>

<span class="sd">        ???+ info &quot;Justification&quot;</span>
<span class="sd">            - The main reason for this function is because when the data was exported from the Legacy WMS&#39;s, there&#39;s a _whole bunch_ of trailing spaces in the data fields. My theory is because of the data type in the source system. That is, if it&#39;s originally stored as &#39;char&#39; type, then it will maintain the data length. This issues doesn&#39;t seem to be affecting the `varchar` fields. Nonetheless, this function will strip the white spaces from the data; thus reducing the total size of the data stored therein.</span>
<span class="sd">            - The reason why it is necessary to write this out as a custom function, instead of using the [`F.trim()`][trim] function from the PySpark library directly is due to the deficiencies of the Java [`trim()`](https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#trim) function. More specifically, there are 13 different whitespace characters available in our ascii character set. The Java function only cleans about 6 of these. So therefore, we define this function which iterates through all 13 whitespace characters, and formats them in to a regular expression, to then parse it to the [`F.regexp_replace()`][regexp_replace] function to be replaced with an empty string (`&quot;&quot;`). Therefore, all 13 characters will be replaced, the strings will be cleaned and trimmed ready for further processing.</span>
<span class="sd">            - The reason why this function exists as a standalone, and does not call [`trim_spaces_from_column()`][toolbox_pyspark.cleaning.trim_spaces_from_column] from within a loop is because [`trim_spaces_from_column()`][toolbox_pyspark.cleaning.trim_spaces_from_column] utilises the [`.withColumn()`][withColumn] method to implement the [`F.regexp_replace()`][regexp_replace] function on columns individually. When implemented iteratively, this process will create huge DAG&#39;s for the RDD, and blow out the complexity to a huge extend. Whereas this [`trim_spaces_from_columns()`][toolbox_pyspark.cleaning.trim_spaces_from_columns] function will utilise the [`.withColumns()`][withColumns] method to implement the [`F.regexp_replace()`][regexp_replace] function over all columns at once. This [`.withColumns()`][withColumns] method projects the function down to the underlying dataset in one single execution; not a different execution per column. Therefore, it is more simpler and more efficient.</span>

<span class="sd">            [withColumn]: https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.withColumn.html</span>
<span class="sd">            [withColumns]: https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.withColumns.html</span>
<span class="sd">            [trim]: https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.trim.html</span>
<span class="sd">            [regexp_replace]: https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.regexp_replace.html</span>

<span class="sd">        ???+ info &quot;Regex definition: `^[...]+|[...]+$`&quot;</span>
<span class="sd">            - 1st Alternative: `^[...]+`</span>
<span class="sd">                - `^` asserts position at start of a line</span>
<span class="sd">                - Match a single character present in the list below `[...]`</span>
<span class="sd">                    - `+` matches the previous token between one and unlimited times, as many times as possible, giving back as needed (greedy)</span>
<span class="sd">                    - matches a single character in the list `  ` (case sensitive)</span>
<span class="sd">                        - matches the character ` ` with index 160 (A0 or 240) literally (case sensitive)</span>
<span class="sd">                        - matches the character ` ` with index 32 (20 or 40) literally (case sensitive)</span>
<span class="sd">                        - ... (repeat for all whitespace characters)</span>
<span class="sd">            - 2nd Alternative: `[...]+$`</span>
<span class="sd">                - Match a single character present in the list below `[...]`</span>
<span class="sd">                    - `+` matches the previous token between one and unlimited times, as many times as possible, giving back as needed (greedy)</span>
<span class="sd">                    - matches a single character in the list `  ` (case sensitive)</span>
<span class="sd">                        - matches the character ` ` with index 160 (A0 or 240) literally (case sensitive)</span>
<span class="sd">                        - matches the character ` ` with index 32 (20 or 40) literally (case sensitive)</span>
<span class="sd">                        - ... (repeat for all whitespace characters)</span>

<span class="sd">    ??? tip &quot;See Also&quot;</span>
<span class="sd">        - [`trim_spaces_from_column()`][toolbox_pyspark.cleaning.trim_spaces_from_column]</span>
<span class="sd">        - [`ALL_WHITESPACE_CHARACTERS`][toolbox_pyspark.constants.ALL_WHITESPACE_CHARACTERS]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="n">get_columns</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span>
    <span class="n">assert_columns_exists</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">match_case</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">space_chars</span><span class="p">:</span> <span class="n">str_list</span> <span class="o">=</span> <span class="n">WHITESPACES</span><span class="o">.</span><span class="n">to_list</span><span class="p">(</span><span class="s2">&quot;chr&quot;</span><span class="p">)</span>  <span class="c1"># type:ignore</span>
    <span class="n">regexp</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;^[</span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">space_chars</span><span class="p">)</span><span class="si">}</span><span class="s2">]+|[</span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">space_chars</span><span class="p">)</span><span class="si">}</span><span class="s2">]+$&quot;</span>
    <span class="n">cols_exprs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Column</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">col</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">regexp_replace</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">regexp</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">withColumns</span><span class="p">(</span><span class="n">cols_exprs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="toolbox_pyspark.cleaning.apply_function_to_column" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">apply_function_to_column</span>


<a href="#toolbox_pyspark.cleaning.apply_function_to_column" class="headerlink" title="Permanent link">🔗</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">apply_function_to_column</span><span class="p">(</span>
    <span class="n">dataframe</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">function</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;upper&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="n">function_args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">function_kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>Apply a given PySpark <code>function</code> to a single <code>column</code> on <code>dataframe</code>.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>Under the hood, this function will simply call the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.withColumn.html"><code>.withColumn()</code></a> method to apply the function named in <code>function</code> from the PySpark <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/functions.html"><code>functions</code></a> module.
<div class="highlight"><pre><span></span><code><span class="k">return</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">function</span><span class="p">)(</span><span class="n">column</span><span class="p">,</span> <span class="o">*</span><span class="n">function_args</span><span class="p">,</span> <span class="o">**</span><span class="n">function_kwargs</span><span class="p">))</span>
</code></pre></div></p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataframe</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame to update.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>column</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The column to update.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>function</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to execute. Must be a valid function from the PySpark <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/functions.html"><code>functions</code></a> module.<br>
Defaults to <code class="highlight"><span class="s2">&quot;upper&quot;</span></code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;upper&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>*function_args</code>
            </td>
            <td>
                  <code>Any</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The arguments to push down to the underlying <code>function</code>.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**function_kwargs</code>
            </td>
            <td>
                  <code>Any</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The keyword arguments to push down to the underlying <code>function</code>.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The updated DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Set up</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Imports</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">toolbox_pyspark.cleaning</span> <span class="kn">import</span> <span class="n">apply_function_to_column</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Instantiate Spark</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="o">...</span>         <span class="p">{</span>
<span class="o">...</span>             <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
<span class="o">...</span>         <span class="p">}</span>
<span class="o">...</span>     <span class="p">)</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Check</span>
<span class="err">```</span><span class="p">{</span><span class="o">.</span><span class="n">py</span> <span class="o">.</span><span class="n">python</span> <span class="n">linenums</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Check&quot;</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+
| a | b | c | d |
+---+---+---+---+
| 0 | a | c | d |
| 1 | b | c | d |
| 2 | c | c | d |
| 3 | d | c | d |
+---+---+---+---+
</code></pre></div>
</div></p>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Default params</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">apply_function_to_column</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+
| a | b | c | d |
+---+---+---+---+
| 0 | a | C | d |
| 1 | b | C | d |
| 2 | c | C | d |
| 3 | d | C | d |
+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully applied the <code>upper</code> function to the <code>c</code> column.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Simple function</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">apply_function_to_column</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+
| a | b | c | d |
+---+---+---+---+
| 0 | a | c | d |
| 1 | b | c | d |
| 2 | c | c | d |
| 3 | d | c | d |
+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully applied the <code>lower</code> function to the <code>c</code> column.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: Complex function, using args</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">apply_function_to_column</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;lpad&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;?&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+-------+
| a | b | c |     d |
+---+---+---+-------+
| 0 | a | c | ????d |
| 1 | b | c | ????d |
| 2 | c | c | ????d |
| 3 | d | c | ????d |
+---+---+---+-------+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully applied the <code>lpad</code> function to the <code>d</code> column.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 4: Complex function, using kwargs</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">new_df</span> <span class="o">=</span> <span class="n">apply_function_to_column</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">dataframe</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">column</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">function</span><span class="o">=</span><span class="s2">&quot;lpad&quot;</span><span class="p">,</span>
<span class="o">...</span>     <span class="nb">len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">pad</span><span class="o">=</span><span class="s2">&quot;?&quot;</span><span class="p">,</span>
<span class="o">...</span> <span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+-------+
| a | b | c |     d |
+---+---+---+-------+
| 0 | a | c | ????d |
| 1 | b | c | ????d |
| 2 | c | c | ????d |
| 3 | d | c | ????d |
+---+---+---+-------+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully applied the <code>lpad</code> function to the <code>d</code> column.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 5: Different complex function, using kwargs</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">new_df</span> <span class="o">=</span> <span class="n">apply_function_to_column</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">dataframe</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">column</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">function</span><span class="o">=</span><span class="s2">&quot;regexp_replace&quot;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">replacement</span><span class="o">=</span><span class="s2">&quot;17&quot;</span><span class="p">,</span>
<span class="o">...</span> <span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+----+---+---+
| a |  b | c | d |
+---+----+---+---+
| 0 |  a | c | d |
| 1 |  b | c | d |
| 2 | 17 | c | d |
| 3 |  d | c | d |
+---+----+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully applied the <code>regexp_replace</code> function to the <code>b</code> column.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 6: Part of pipe</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">new_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">func</span><span class="o">=</span><span class="n">apply_function_to_column</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">column</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">function</span><span class="o">=</span><span class="s2">&quot;lpad&quot;</span><span class="p">,</span>
<span class="o">...</span>     <span class="nb">len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">pad</span><span class="o">=</span><span class="s2">&quot;?&quot;</span><span class="p">,</span>
<span class="o">...</span> <span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+-------+
| a | b | c |     d |
+---+---+---+-------+
| 0 | a | c | ????d |
| 1 | b | c | ????d |
| 2 | c | c | ????d |
| 3 | d | c | ????d |
+---+---+---+-------+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully applied the <code>lpad</code> function to the <code>d</code> column.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 7: Column name in different case</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">new_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">func</span><span class="o">=</span><span class="n">apply_function_to_column</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">column</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">function</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span>
<span class="o">...</span> <span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+
| a | b | c | d |
+---+---+---+---+
| 0 | a | c | D |
| 1 | b | c | D |
| 2 | c | c | D |
| 3 | d | c | D |
+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully applied the <code>upper</code> function to the <code>D</code> column.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 8: Invalid column</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">apply_function_to_column</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>ColumnDoesNotExistError: Column &#39;f&#39; does not exist in the DataFrame.
Try one of: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;]
</code></pre></div></p>
<div class="admonition failure">
<p class="admonition-title">Conclusion: Column does not exist.</p>
</div>
</div>
</details>
<details class="info">
<summary>Notes</summary>
<ul>
<li>We have to name the <code>function</code> parameter as the full name because when this function is executed as part of a chain (by using the PySpark <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.transform.html"><code>.transform()</code></a> method), that one uses the <code>func</code> parameter.</li>
</ul>
</details>
<details class="tip">
<summary>See Also</summary>
<ul>
<li><a class="autorefs autorefs-internal" href="#toolbox_pyspark.cleaning.apply_function_to_columns"><code>apply_function_to_columns()</code></a></li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>src/toolbox_pyspark/cleaning.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span> <span class="nf">apply_function_to_column</span><span class="p">(</span>
    <span class="n">dataframe</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">function</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;upper&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="n">function_args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">function_kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        Apply a given PySpark `function` to a single `column` on `dataframe`.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>
<span class="sd">        Under the hood, this function will simply call the [`.withColumn()`](https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.withColumn.html) method to apply the function named in `function` from the PySpark [`functions`](https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/functions.html) module.</span>
<span class="sd">        ```py</span>
<span class="sd">        return dataframe.withColumn(column, getattr(F, function)(column, *function_args, **function_kwargs))</span>
<span class="sd">        ```</span>

<span class="sd">    Params:</span>
<span class="sd">        dataframe (psDataFrame):</span>
<span class="sd">            The DataFrame to update.</span>
<span class="sd">        column (str):</span>
<span class="sd">            The column to update.</span>
<span class="sd">        function (str, optional):</span>
<span class="sd">            The function to execute. Must be a valid function from the PySpark [`functions`](https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/functions.html) module.&lt;br&gt;</span>
<span class="sd">            Defaults to `#!py &quot;upper&quot;`.</span>
<span class="sd">        *function_args (Any, optional):</span>
<span class="sd">            The arguments to push down to the underlying `function`.</span>
<span class="sd">        **function_kwargs (Any, optional):</span>
<span class="sd">            The keyword arguments to push down to the underlying `function`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (psDataFrame):</span>
<span class="sd">            The updated DataFrame.</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Set up&quot;}</span>
<span class="sd">        &gt;&gt;&gt; # Imports</span>
<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; from pyspark.sql import SparkSession</span>
<span class="sd">        &gt;&gt;&gt; from toolbox_pyspark.cleaning import apply_function_to_column</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Instantiate Spark</span>
<span class="sd">        &gt;&gt;&gt; spark = SparkSession.builder.getOrCreate()</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Create data</span>
<span class="sd">        &gt;&gt;&gt; df = spark.createDataFrame(</span>
<span class="sd">        ...     pd.DataFrame(</span>
<span class="sd">        ...         {</span>
<span class="sd">        ...             &quot;a&quot;: [0, 1, 2, 3],</span>
<span class="sd">        ...             &quot;b&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;],</span>
<span class="sd">        ...             &quot;c&quot;: [&quot;c&quot;, &quot;c&quot;, &quot;c&quot;, &quot;c&quot;],</span>
<span class="sd">        ...             &quot;d&quot;: [&quot;d&quot;, &quot;d&quot;, &quot;d&quot;, &quot;d&quot;],</span>
<span class="sd">        ...         }</span>
<span class="sd">        ...     )</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Check</span>
<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Check&quot;}</span>
<span class="sd">        &gt;&gt;&gt; df.show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | a | b | c | d |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | 0 | a | c | d |</span>
<span class="sd">        | 1 | b | c | d |</span>
<span class="sd">        | 2 | c | c | d |</span>
<span class="sd">        | 3 | d | c | d |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 1: Default params&quot;}</span>
<span class="sd">        &gt;&gt;&gt; apply_function_to_column(df, &quot;c&quot;).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | a | b | c | d |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | 0 | a | C | d |</span>
<span class="sd">        | 1 | b | C | d |</span>
<span class="sd">        | 2 | c | C | d |</span>
<span class="sd">        | 3 | d | C | d |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully applied the `upper` function to the `c` column.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 2: Simple function&quot;}</span>
<span class="sd">        &gt;&gt;&gt; apply_function_to_column(df, &quot;c&quot;, &quot;lower&quot;).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | a | b | c | d |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | 0 | a | c | d |</span>
<span class="sd">        | 1 | b | c | d |</span>
<span class="sd">        | 2 | c | c | d |</span>
<span class="sd">        | 3 | d | c | d |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully applied the `lower` function to the `c` column.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 3: Complex function, using args&quot;}</span>
<span class="sd">        &gt;&gt;&gt; apply_function_to_column(df, &quot;d&quot;, &quot;lpad&quot;, 5, &quot;?&quot;).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+-------+</span>
<span class="sd">        | a | b | c |     d |</span>
<span class="sd">        +---+---+---+-------+</span>
<span class="sd">        | 0 | a | c | ????d |</span>
<span class="sd">        | 1 | b | c | ????d |</span>
<span class="sd">        | 2 | c | c | ????d |</span>
<span class="sd">        | 3 | d | c | ????d |</span>
<span class="sd">        +---+---+---+-------+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully applied the `lpad` function to the `d` column.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 4: Complex function, using kwargs&quot;}</span>
<span class="sd">        &gt;&gt;&gt; new_df = apply_function_to_column(</span>
<span class="sd">        ...     dataframe=df,</span>
<span class="sd">        ...     column=&quot;d&quot;,</span>
<span class="sd">        ...     function=&quot;lpad&quot;,</span>
<span class="sd">        ...     len=5,</span>
<span class="sd">        ...     pad=&quot;?&quot;,</span>
<span class="sd">        ... ).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+-------+</span>
<span class="sd">        | a | b | c |     d |</span>
<span class="sd">        +---+---+---+-------+</span>
<span class="sd">        | 0 | a | c | ????d |</span>
<span class="sd">        | 1 | b | c | ????d |</span>
<span class="sd">        | 2 | c | c | ????d |</span>
<span class="sd">        | 3 | d | c | ????d |</span>
<span class="sd">        +---+---+---+-------+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully applied the `lpad` function to the `d` column.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 5: Different complex function, using kwargs&quot;}</span>
<span class="sd">        &gt;&gt;&gt; new_df = apply_function_to_column(</span>
<span class="sd">        ...     dataframe=df,</span>
<span class="sd">        ...     column=&quot;b&quot;,</span>
<span class="sd">        ...     function=&quot;regexp_replace&quot;,</span>
<span class="sd">        ...     pattern=&quot;c&quot;,</span>
<span class="sd">        ...     replacement=&quot;17&quot;,</span>
<span class="sd">        ... ).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+----+---+---+</span>
<span class="sd">        | a |  b | c | d |</span>
<span class="sd">        +---+----+---+---+</span>
<span class="sd">        | 0 |  a | c | d |</span>
<span class="sd">        | 1 |  b | c | d |</span>
<span class="sd">        | 2 | 17 | c | d |</span>
<span class="sd">        | 3 |  d | c | d |</span>
<span class="sd">        +---+----+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully applied the `regexp_replace` function to the `b` column.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 6: Part of pipe&quot;}</span>
<span class="sd">        &gt;&gt;&gt; new_df = df.transform(</span>
<span class="sd">        ...     func=apply_function_to_column,</span>
<span class="sd">        ...     column=&quot;d&quot;,</span>
<span class="sd">        ...     function=&quot;lpad&quot;,</span>
<span class="sd">        ...     len=5,</span>
<span class="sd">        ...     pad=&quot;?&quot;,</span>
<span class="sd">        ... ).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+-------+</span>
<span class="sd">        | a | b | c |     d |</span>
<span class="sd">        +---+---+---+-------+</span>
<span class="sd">        | 0 | a | c | ????d |</span>
<span class="sd">        | 1 | b | c | ????d |</span>
<span class="sd">        | 2 | c | c | ????d |</span>
<span class="sd">        | 3 | d | c | ????d |</span>
<span class="sd">        +---+---+---+-------+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully applied the `lpad` function to the `d` column.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 7: Column name in different case&quot;}</span>
<span class="sd">        &gt;&gt;&gt; new_df = df.transform(</span>
<span class="sd">        ...     func=apply_function_to_column,</span>
<span class="sd">        ...     column=&quot;D&quot;,</span>
<span class="sd">        ...     function=&quot;upper&quot;,</span>
<span class="sd">        ... ).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | a | b | c | d |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | 0 | a | c | D |</span>
<span class="sd">        | 1 | b | c | D |</span>
<span class="sd">        | 2 | c | c | D |</span>
<span class="sd">        | 3 | d | c | D |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully applied the `upper` function to the `D` column.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 8: Invalid column&quot;}</span>
<span class="sd">        &gt;&gt;&gt; apply_function_to_column(df, &quot;f&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        ColumnDoesNotExistError: Column &#39;f&#39; does not exist in the DataFrame.</span>
<span class="sd">        Try one of: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;]</span>
<span class="sd">        ```</span>
<span class="sd">        !!! failure &quot;Conclusion: Column does not exist.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">    ??? info &quot;Notes&quot;</span>
<span class="sd">        - We have to name the `function` parameter as the full name because when this function is executed as part of a chain (by using the PySpark [`.transform()`](https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.transform.html) method), that one uses the `func` parameter.</span>

<span class="sd">    ??? tip &quot;See Also&quot;</span>
<span class="sd">        - [`apply_function_to_columns()`][toolbox_pyspark.cleaning.apply_function_to_columns]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">assert_column_exists</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="n">colName</span><span class="o">=</span><span class="n">column</span><span class="p">,</span>
        <span class="n">col</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">function</span><span class="p">)(</span><span class="n">column</span><span class="p">,</span> <span class="o">*</span><span class="n">function_args</span><span class="p">,</span> <span class="o">**</span><span class="n">function_kwargs</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="toolbox_pyspark.cleaning.apply_function_to_columns" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">apply_function_to_columns</span>


<a href="#toolbox_pyspark.cleaning.apply_function_to_columns" class="headerlink" title="Permanent link">🔗</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">apply_function_to_columns</span><span class="p">(</span>
    <span class="n">dataframe</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">str_collection</span><span class="p">],</span>
    <span class="n">function</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;upper&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="n">function_args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">function_kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>Apply a given PySpark <code>function</code> over multiple <code>columns</code> on a given <code>dataframe</code>.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>Under the hood, this function will simply call the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.withColumns.html"><code>.withColumns()</code></a> method to apply the function named in <code>function</code> from the PySpark <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/functions.html"><code>functions</code></a> module.
<div class="highlight"><pre><span></span><code><span class="k">return</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">withColumns</span><span class="p">(</span>
    <span class="p">{</span><span class="n">column</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">function</span><span class="p">)(</span><span class="n">column</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">}</span>
<span class="p">)</span>
</code></pre></div></p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataframe</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame to update.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, <span title="toolbox_python.collection_types.str_collection">str_collection</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The columns to update.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>function</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to use.<br>
Defaults to <code class="highlight"><span class="s2">&quot;upper&quot;</span></code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;upper&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The updated DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Set up</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Imports</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">toolbox_pyspark.cleaning</span> <span class="kn">import</span> <span class="n">apply_function_to_columns</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Instantiate Spark</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="o">...</span>         <span class="p">{</span>
<span class="o">...</span>             <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
<span class="o">...</span>         <span class="p">}</span>
<span class="o">...</span>     <span class="p">)</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Check</span>
<span class="err">```</span><span class="p">{</span><span class="o">.</span><span class="n">py</span> <span class="o">.</span><span class="n">python</span> <span class="n">linenums</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Check&quot;</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+
| a | b | c | d |
+---+---+---+---+
| 0 | a | c | d |
| 1 | b | c | d |
| 2 | c | c | d |
| 3 | d | c | d |
+---+---+---+---+
</code></pre></div>
</div></p>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Default params</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">apply_function_to_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+
| a | b | c | d |
+---+---+---+---+
| 0 | A | C | d |
| 1 | B | C | d |
| 2 | C | C | d |
| 3 | D | C | d |
+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully applied the <code>upper</code> function to the <code>b</code> and <code>c</code> columns.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Simple function</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">apply_function_to_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span> <span class="s2">&quot;lower&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+
| a | b | c | d |
+---+---+---+---+
| 0 | a | c | d |
| 1 | b | c | d |
| 2 | c | c | d |
| 3 | d | c | d |
+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully applied the <code>lower</code> function to the <code>b</code> and <code>c</code> columns.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: Complex function, with args</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">apply_function_to_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span> <span class="s2">&quot;lpad&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;?&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+-------+-------+-------+
| a |     b |     c |     d |
+---+-------+-------+-------+
| 0 | ????a | ????c | ????d |
| 1 | ????b | ????c | ????d |
| 2 | ????c | ????c | ????d |
| 3 | ????d | ????c | ????d |
+---+-------+-------+-------+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully applied the <code>lpad</code> function to the <code>b</code>, <code>c</code> and <code>d</code> columns.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 4: Complex function, with kwargs</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">apply_function_to_columns</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">dataframe</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">function</span><span class="o">=</span><span class="s2">&quot;lpad&quot;</span><span class="p">,</span>
<span class="o">...</span>     <span class="nb">len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">pad</span><span class="o">=</span><span class="s2">&quot;?&quot;</span><span class="p">,</span>
<span class="o">...</span> <span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+-------+-------+-------+
| a |     b |     c |     d |
+---+-------+-------+-------+
| 0 | ????a | ????c | ????d |
| 1 | ????b | ????c | ????d |
| 2 | ????c | ????c | ????d |
| 3 | ????d | ????c | ????d |
+---+-------+-------+-------+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully applied the <code>lpad</code> function to the <code>b</code>, <code>c</code> and <code>d</code> columns.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 5: Different complex function, with kwargs</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">apply_function_to_columns</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">dataframe</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">function</span><span class="o">=</span><span class="s2">&quot;regexp_replace&quot;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">replacement</span><span class="o">=</span><span class="s2">&quot;17&quot;</span><span class="p">,</span>
<span class="o">...</span> <span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+----+----+---+
| a |  b |  c | d |
+---+----+----+---+
| 0 |  a | 17 | d |
| 1 |  b | 17 | d |
| 2 | 17 | 17 | d |
| 3 |  d | 17 | d |
+---+----+----+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully applied the <code>regexp_replace</code> function to the <code>b</code>, <code>c</code> and <code>d</code> columns.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 6: Part of pipe</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">func</span><span class="o">=</span><span class="n">apply_function_to_columns</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">function</span><span class="o">=</span><span class="s2">&quot;lpad&quot;</span><span class="p">,</span>
<span class="o">...</span>     <span class="nb">len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">pad</span><span class="o">=</span><span class="s2">&quot;?&quot;</span><span class="p">,</span>
<span class="o">...</span> <span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+-------+-------+-------+
| a |     b |     c |     d |
+---+-------+-------+-------+
| 0 | ????a | ????c | ????d |
| 1 | ????b | ????c | ????d |
| 2 | ????c | ????c | ????d |
| 3 | ????d | ????c | ????d |
+---+-------+-------+-------+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully applied the <code>lpad</code> function to the <code>b</code>, <code>c</code> and <code>d</code> columns.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 7: Column name in different case</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">apply_function_to_columns</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">dataframe</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">function</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span>
<span class="o">...</span> <span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+
| a | b | c | d |
+---+---+---+---+
| 0 | A | C | D |
| 1 | B | C | D |
| 2 | C | C | D |
| 3 | D | C | D |
+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully applied the <code>upper</code> function to the <code>B</code>, <code>c</code> and <code>D</code> columns.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 8: Invalid columns</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">apply_function_to_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>ColumnDoesNotExistError: Columns [&#39;f&#39;] do not exist in the DataFrame.
Try one of: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;]
</code></pre></div></p>
<div class="admonition failure">
<p class="admonition-title">Conclusion: Columns do not exist.</p>
</div>
</div>
</details>
<details class="info">
<summary>Notes</summary>
<ul>
<li>We have to name the <code>function</code> parameter as the full name because when this function is executed as part of a chain (by using the PySpark <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.transform.html"><code>.transform()</code></a> method), that one uses the <code>func</code> parameter.</li>
</ul>
</details>
<details class="tip">
<summary>See Also</summary>
<ul>
<li><a class="autorefs autorefs-internal" href="#toolbox_pyspark.cleaning.apply_function_to_column"><code>apply_function_to_column()</code></a></li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>src/toolbox_pyspark/cleaning.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span> <span class="nf">apply_function_to_columns</span><span class="p">(</span>
    <span class="n">dataframe</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">str_collection</span><span class="p">],</span>
    <span class="n">function</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;upper&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="n">function_args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">function_kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        Apply a given PySpark `function` over multiple `columns` on a given `dataframe`.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>
<span class="sd">        Under the hood, this function will simply call the [`.withColumns()`](https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.withColumns.html) method to apply the function named in `function` from the PySpark [`functions`](https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/functions.html) module.</span>
<span class="sd">        ```py</span>
<span class="sd">        return dataframe.withColumns(</span>
<span class="sd">            {column: getattr(F, function)(column, *args, **kwargs) for column in columns}</span>
<span class="sd">        )</span>
<span class="sd">        ```</span>

<span class="sd">    Params:</span>
<span class="sd">        dataframe (psDataFrame):</span>
<span class="sd">            The DataFrame to update.</span>
<span class="sd">        columns (Union[str, str_collection]):</span>
<span class="sd">            The columns to update.</span>
<span class="sd">        function (str, optional):</span>
<span class="sd">            The function to use.&lt;br&gt;</span>
<span class="sd">            Defaults to `#!py &quot;upper&quot;`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (psDataFrame):</span>
<span class="sd">            The updated DataFrame.</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Set up&quot;}</span>
<span class="sd">        &gt;&gt;&gt; # Imports</span>
<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; from pyspark.sql import SparkSession</span>
<span class="sd">        &gt;&gt;&gt; from toolbox_pyspark.cleaning import apply_function_to_columns</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Instantiate Spark</span>
<span class="sd">        &gt;&gt;&gt; spark = SparkSession.builder.getOrCreate()</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Create data</span>
<span class="sd">        &gt;&gt;&gt; df = spark.createDataFrame(</span>
<span class="sd">        ...     pd.DataFrame(</span>
<span class="sd">        ...         {</span>
<span class="sd">        ...             &quot;a&quot;: [0, 1, 2, 3],</span>
<span class="sd">        ...             &quot;b&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;],</span>
<span class="sd">        ...             &quot;c&quot;: [&quot;c&quot;, &quot;c&quot;, &quot;c&quot;, &quot;c&quot;],</span>
<span class="sd">        ...             &quot;d&quot;: [&quot;d&quot;, &quot;d&quot;, &quot;d&quot;, &quot;d&quot;],</span>
<span class="sd">        ...         }</span>
<span class="sd">        ...     )</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Check</span>
<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Check&quot;}</span>
<span class="sd">        &gt;&gt;&gt; df.show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | a | b | c | d |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | 0 | a | c | d |</span>
<span class="sd">        | 1 | b | c | d |</span>
<span class="sd">        | 2 | c | c | d |</span>
<span class="sd">        | 3 | d | c | d |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 1: Default params&quot;}</span>
<span class="sd">        &gt;&gt;&gt; apply_function_to_columns(df, [&quot;b&quot;, &quot;c&quot;]).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | a | b | c | d |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | 0 | A | C | d |</span>
<span class="sd">        | 1 | B | C | d |</span>
<span class="sd">        | 2 | C | C | d |</span>
<span class="sd">        | 3 | D | C | d |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully applied the `upper` function to the `b` and `c` columns.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 2: Simple function&quot;}</span>
<span class="sd">        &gt;&gt;&gt; apply_function_to_columns(df, [&quot;b&quot;, &quot;c&quot;], &quot;lower&quot;).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | a | b | c | d |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | 0 | a | c | d |</span>
<span class="sd">        | 1 | b | c | d |</span>
<span class="sd">        | 2 | c | c | d |</span>
<span class="sd">        | 3 | d | c | d |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully applied the `lower` function to the `b` and `c` columns.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 3: Complex function, with args&quot;}</span>
<span class="sd">        &gt;&gt;&gt; apply_function_to_columns(df, [&quot;b&quot;, &quot;c&quot;, &quot;d&quot;], &quot;lpad&quot;, 5, &quot;?&quot;).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+-------+-------+-------+</span>
<span class="sd">        | a |     b |     c |     d |</span>
<span class="sd">        +---+-------+-------+-------+</span>
<span class="sd">        | 0 | ????a | ????c | ????d |</span>
<span class="sd">        | 1 | ????b | ????c | ????d |</span>
<span class="sd">        | 2 | ????c | ????c | ????d |</span>
<span class="sd">        | 3 | ????d | ????c | ????d |</span>
<span class="sd">        +---+-------+-------+-------+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully applied the `lpad` function to the `b`, `c` and `d` columns.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 4: Complex function, with kwargs&quot;}</span>
<span class="sd">        &gt;&gt;&gt; apply_function_to_columns(</span>
<span class="sd">        ...     dataframe=df,</span>
<span class="sd">        ...     columns=[&quot;b&quot;, &quot;c&quot;, &quot;d&quot;],</span>
<span class="sd">        ...     function=&quot;lpad&quot;,</span>
<span class="sd">        ...     len=5,</span>
<span class="sd">        ...     pad=&quot;?&quot;,</span>
<span class="sd">        ... ).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+-------+-------+-------+</span>
<span class="sd">        | a |     b |     c |     d |</span>
<span class="sd">        +---+-------+-------+-------+</span>
<span class="sd">        | 0 | ????a | ????c | ????d |</span>
<span class="sd">        | 1 | ????b | ????c | ????d |</span>
<span class="sd">        | 2 | ????c | ????c | ????d |</span>
<span class="sd">        | 3 | ????d | ????c | ????d |</span>
<span class="sd">        +---+-------+-------+-------+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully applied the `lpad` function to the `b`, `c` and `d` columns.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 5: Different complex function, with kwargs&quot;}</span>
<span class="sd">        &gt;&gt;&gt; apply_function_to_columns(</span>
<span class="sd">        ...     dataframe=df,</span>
<span class="sd">        ...     columns=[&quot;b&quot;, &quot;c&quot;, &quot;d&quot;],</span>
<span class="sd">        ...     function=&quot;regexp_replace&quot;,</span>
<span class="sd">        ...     pattern=&quot;c&quot;,</span>
<span class="sd">        ...     replacement=&quot;17&quot;,</span>
<span class="sd">        ... ).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+----+----+---+</span>
<span class="sd">        | a |  b |  c | d |</span>
<span class="sd">        +---+----+----+---+</span>
<span class="sd">        | 0 |  a | 17 | d |</span>
<span class="sd">        | 1 |  b | 17 | d |</span>
<span class="sd">        | 2 | 17 | 17 | d |</span>
<span class="sd">        | 3 |  d | 17 | d |</span>
<span class="sd">        +---+----+----+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully applied the `regexp_replace` function to the `b`, `c` and `d` columns.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 6: Part of pipe&quot;}</span>
<span class="sd">        &gt;&gt;&gt; df.transform(</span>
<span class="sd">        ...     func=apply_function_to_columns,</span>
<span class="sd">        ...     columns=[&quot;b&quot;, &quot;c&quot;, &quot;d&quot;],</span>
<span class="sd">        ...     function=&quot;lpad&quot;,</span>
<span class="sd">        ...     len=5,</span>
<span class="sd">        ...     pad=&quot;?&quot;,</span>
<span class="sd">        ... ).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+-------+-------+-------+</span>
<span class="sd">        | a |     b |     c |     d |</span>
<span class="sd">        +---+-------+-------+-------+</span>
<span class="sd">        | 0 | ????a | ????c | ????d |</span>
<span class="sd">        | 1 | ????b | ????c | ????d |</span>
<span class="sd">        | 2 | ????c | ????c | ????d |</span>
<span class="sd">        | 3 | ????d | ????c | ????d |</span>
<span class="sd">        +---+-------+-------+-------+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully applied the `lpad` function to the `b`, `c` and `d` columns.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 7: Column name in different case&quot;}</span>
<span class="sd">        &gt;&gt;&gt; apply_function_to_columns(</span>
<span class="sd">        ...     dataframe=df,</span>
<span class="sd">        ...     columns=[&quot;B&quot;, &quot;c&quot;, &quot;D&quot;],</span>
<span class="sd">        ...     function=&quot;upper&quot;,</span>
<span class="sd">        ... ).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | a | b | c | d |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | 0 | A | C | D |</span>
<span class="sd">        | 1 | B | C | D |</span>
<span class="sd">        | 2 | C | C | D |</span>
<span class="sd">        | 3 | D | C | D |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully applied the `upper` function to the `B`, `c` and `D` columns.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 8: Invalid columns&quot;}</span>
<span class="sd">        &gt;&gt;&gt; apply_function_to_columns(df, [&quot;f&quot;])</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        ColumnDoesNotExistError: Columns [&#39;f&#39;] do not exist in the DataFrame.</span>
<span class="sd">        Try one of: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;]</span>
<span class="sd">        ```</span>
<span class="sd">        !!! failure &quot;Conclusion: Columns do not exist.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">    ??? info &quot;Notes&quot;</span>
<span class="sd">        - We have to name the `function` parameter as the full name because when this function is executed as part of a chain (by using the PySpark [`.transform()`](https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.transform.html) method), that one uses the `func` parameter.</span>

<span class="sd">    ??? tip &quot;See Also&quot;</span>
<span class="sd">        - [`apply_function_to_column()`][toolbox_pyspark.cleaning.apply_function_to_column]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="n">get_columns</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span>
    <span class="n">assert_columns_exists</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">withColumns</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="n">column</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">function</span><span class="p">)(</span><span class="n">column</span><span class="p">,</span> <span class="o">*</span><span class="n">function_args</span><span class="p">,</span> <span class="o">**</span><span class="n">function_kwargs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span>
        <span class="p">}</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="toolbox_pyspark.cleaning.drop_matching_rows" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">drop_matching_rows</span>


<a href="#toolbox_pyspark.cleaning.drop_matching_rows" class="headerlink" title="Permanent link">🔗</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">drop_matching_rows</span><span class="p">(</span>
    <span class="n">left_table</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">right_table</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">on_keys</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">str_collection</span><span class="p">],</span>
    <span class="n">join_type</span><span class="p">:</span> <span class="n">VALID_PYAPARK_JOIN_TYPES</span> <span class="o">=</span> <span class="s2">&quot;left_anti&quot;</span><span class="p">,</span>
    <span class="n">where_clause</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>This function is designed to <em>remove</em> any rows on the <code>left_table</code> which <em>are</em> existing on the <code>right_table</code>. That's why the <code>join_type</code> should always be <code>left_anti</code>.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>The intention behind this function is originating from the <code>Accumulation</code> layer in the BigDaS environment. The process on this table layer is to only <em>insert</em> rows from the <code>left_table</code> to the <code>right_table</code> with are <strong>not existing</strong> on the <code>right_table</code>. We include the <code>where_clause</code> here so that we can control any updated rows. Specifically, we check the <code>editdatetime</code> field between the <code>left_table</code> and the <code>right_table</code>, and any record on the <code>left_table</code> where the <code>editdatetime</code> field is <em>greater than</em> the <code>editdatetime</code> value on the <code>right_table</code>, then this row will <em>remain</em> on the <code>left_table</code>, and will later be <em>updated</em> on the <code>right_table</code>.</p>
<p>It's important to specify here that this function was created to handle the <em>same table</em> between the <code>left_table</code> and the <code>right_table</code>, which are existing between different layers in the ADLS environment. Logically, it can be used for other purposes (it's generic enough); however, the intention was specifically for cleaning during the data pipeline processes.</p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>left_table</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame <em>from which</em> you will be deleting the records.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>right_table</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame <em>from which</em> to check for existing records. If any matching <code>on_keys</code> are existing on both the <code>right_table</code> and the <code>left_table</code>, then those records will be deleted from the <code>left_table</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>on_keys</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, <span title="toolbox_python.collection_types.str_collection">str_collection</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matching keys between the two tables. These keys (aka columns) must be existing on both the <code>left_table</code> and the <code>right_table</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>join_type</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="toolbox_pyspark.constants.VALID_PYAPARK_JOIN_TYPES" href="../constants/#toolbox_pyspark.constants.VALID_PYAPARK_JOIN_TYPES">VALID_PYAPARK_JOIN_TYPES</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of join to use for this process. For the best performance, keep it as the default value.<br>
Defaults to <code class="highlight"><span class="s2">&quot;left_anti&quot;</span></code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;left_anti&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>where_clause</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Any additional conditions to place on this join. Any records which <strong>match</strong> this condition will be <strong>kept</strong> on the <code>left_table</code>.<br>
Defaults to <code class="highlight"><span class="kc">None</span></code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The <code>left_table</code> after it has had it's rows deleted and cleaned by the <code>right_table</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Set up</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Imports</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">toolbox_pyspark.cleaning</span> <span class="kn">import</span> <span class="n">drop_matching_rows</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Instantiate Spark</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">left</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="o">...</span>         <span class="p">{</span>
<span class="o">...</span>             <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
<span class="o">...</span>         <span class="p">}</span>
<span class="o">...</span>     <span class="p">)</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">...</span> <span class="n">right</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;a in (&quot;</span><span class="mi">1</span><span class="s2">&quot;, &quot;</span><span class="mi">2</span><span class="s2">&quot;)&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Check</span>
<span class="err">```</span><span class="p">{</span><span class="o">.</span><span class="n">py</span> <span class="o">.</span><span class="n">python</span> <span class="n">linenums</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Check&quot;</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">left</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">right</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+---+
| a | b | c | d | n |
+---+---+---+---+---+
| 1 | a | 1 | 2 | a |
| 2 | b | 1 | 2 | b |
| 3 | c | 1 | 2 | c |
| 4 | d | 1 | 2 | d |
+---+---+---+---+---+
</code></pre></div>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+---+
| a | b | c | d | n |
+---+---+---+---+---+
| 1 | a | 1 | 2 | a |
| 2 | b | 1 | 2 | b |
+---+---+---+---+---+
</code></pre></div>
</div></p>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Single column</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">drop_matching_rows</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">left_table</span><span class="o">=</span><span class="n">left</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">right_table</span><span class="o">=</span><span class="n">right</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">on_keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">],</span>
<span class="o">...</span> <span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+---+
| a | b | c | d | n |
+---+---+---+---+---+
| 3 | c | 1 | 2 | c |
| 4 | d | 1 | 2 | d |
+---+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully removed the records from the <code>left_table</code> which are existing on the <code>right_table</code>.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Single column as string</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">left</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">drop_matching_rows</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">right_table</span><span class="o">=</span><span class="n">right</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">on_keys</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">,</span>
<span class="o">...</span> <span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+---+
| a | b | c | d | n |
+---+---+---+---+---+
| 3 | c | 1 | 2 | c |
| 4 | d | 1 | 2 | d |
+---+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully removed the records from the <code>left_table</code> which are existing on the <code>right_table</code>.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: Multiple key columns</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">drop_matching_rows</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">left_table</span><span class="o">=</span><span class="n">left</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">right_table</span><span class="o">=</span><span class="n">right</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">on_keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span>
<span class="o">...</span> <span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+---+
| a | b | c | d | n |
+---+---+---+---+---+
| 3 | c | 1 | 2 | c |
| 4 | d | 1 | 2 | d |
+---+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully removed the records from the <code>left_table</code> which are existing on the <code>right_table</code>.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 4: Including `where` clause</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">drop_matching_rows</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">left_table</span><span class="o">=</span><span class="n">left</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">right_table</span><span class="o">=</span><span class="n">right</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">on_keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">where_clause</span><span class="o">=</span><span class="s2">&quot;n &lt;&gt; &#39;d&#39;&quot;</span><span class="p">,</span>
<span class="o">...</span> <span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+---+
| a | b | c | d | n |
+---+---+---+---+---+
| 3 | c | 1 | 2 | c |
+---+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully removed the records from the <code>left_table</code> which are existing on the <code>right_table</code> and matched the <code>where</code> clause.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 5: Part of pipe</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">left</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">func</span><span class="o">=</span><span class="n">drop_matching_rows</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">right_table</span><span class="o">=</span><span class="n">right</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">on_keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">],</span>
<span class="o">...</span> <span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+---+
| a | b | c | d | n |
+---+---+---+---+---+
| 3 | c | 1 | 2 | c |
| 4 | d | 1 | 2 | d |
+---+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully removed the records from the <code>left_table</code> which are existing on the <code>right_table</code>.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 6: Invalid column</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">drop_matching_rows</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">left_table</span><span class="o">=</span><span class="n">left</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">right_table</span><span class="o">=</span><span class="n">right</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">on_keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">],</span>
<span class="o">...</span> <span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>ColumnDoesNotExistError: Columns [&#39;f&#39;] do not exist in the DataFrame.
Try one of: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;n&quot;]
</code></pre></div></p>
<div class="admonition failure">
<p class="admonition-title">Conclusion: Columns do not exist.</p>
</div>
</div>
</details>
<details class="info">
<summary>Notes</summary>
<ul>
<li>The <code>on_keys</code> parameter can be a single string or a list of strings. This is to allow for multiple columns to be used as the matching keys.</li>
<li>The <code>where_clause</code> parameter is optional. If specified, then only the records which match the condition will be kept on the <code>left_table</code>. It is applied after the join. If not specified, then all records which are existing on the <code>right_table</code> will be removed from the <code>left_table</code>.</li>
</ul>
</details>
<details class="tip">
<summary>See Also</summary>
<ul>
<li><a class="autorefs autorefs-internal" href="../checks/#toolbox_pyspark.checks.assert_columns_exists"><code>assert_columns_exists()</code></a></li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>src/toolbox_pyspark/cleaning.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span> <span class="nf">drop_matching_rows</span><span class="p">(</span>
    <span class="n">left_table</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">right_table</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">on_keys</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">str_collection</span><span class="p">],</span>
    <span class="n">join_type</span><span class="p">:</span> <span class="n">VALID_PYAPARK_JOIN_TYPES</span> <span class="o">=</span> <span class="s2">&quot;left_anti&quot;</span><span class="p">,</span>
    <span class="n">where_clause</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        This function is designed to _remove_ any rows on the `left_table` which _are_ existing on the `right_table`. That&#39;s why the `join_type` should always be `left_anti`.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>
<span class="sd">        The intention behind this function is originating from the `Accumulation` layer in the BigDaS environment. The process on this table layer is to only _insert_ rows from the `left_table` to the `right_table` with are **not existing** on the `right_table`. We include the `where_clause` here so that we can control any updated rows. Specifically, we check the `editdatetime` field between the `left_table` and the `right_table`, and any record on the `left_table` where the `editdatetime` field is _greater than_ the `editdatetime` value on the `right_table`, then this row will _remain_ on the `left_table`, and will later be _updated_ on the `right_table`.</span>

<span class="sd">        It&#39;s important to specify here that this function was created to handle the _same table_ between the `left_table` and the `right_table`, which are existing between different layers in the ADLS environment. Logically, it can be used for other purposes (it&#39;s generic enough); however, the intention was specifically for cleaning during the data pipeline processes.</span>

<span class="sd">    Params:</span>
<span class="sd">        left_table (psDataFrame):</span>
<span class="sd">            The DataFrame _from which_ you will be deleting the records.</span>
<span class="sd">        right_table (psDataFrame):</span>
<span class="sd">            The DataFrame _from which_ to check for existing records. If any matching `on_keys` are existing on both the `right_table` and the `left_table`, then those records will be deleted from the `left_table`.</span>
<span class="sd">        on_keys (Union[str, str_collection]):</span>
<span class="sd">            The matching keys between the two tables. These keys (aka columns) must be existing on both the `left_table` and the `right_table`.</span>
<span class="sd">        join_type (VALID_PYAPARK_JOIN_TYPES, optional):</span>
<span class="sd">            The type of join to use for this process. For the best performance, keep it as the default value.&lt;br&gt;</span>
<span class="sd">            Defaults to `#!py &quot;left_anti&quot;`.</span>
<span class="sd">        where_clause (Optional[str], optional):</span>
<span class="sd">            Any additional conditions to place on this join. Any records which **match** this condition will be **kept** on the `left_table`.&lt;br&gt;</span>
<span class="sd">            Defaults to `#!py None`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (psDataFrame):</span>
<span class="sd">            The `left_table` after it has had it&#39;s rows deleted and cleaned by the `right_table`.</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Set up&quot;}</span>
<span class="sd">        &gt;&gt;&gt; # Imports</span>
<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; from pyspark.sql import SparkSession</span>
<span class="sd">        &gt;&gt;&gt; from toolbox_pyspark.cleaning import drop_matching_rows</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Instantiate Spark</span>
<span class="sd">        &gt;&gt;&gt; spark = SparkSession.builder.getOrCreate()</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Create data</span>
<span class="sd">        &gt;&gt;&gt; left = spark.createDataFrame(</span>
<span class="sd">        ...     pd.DataFrame(</span>
<span class="sd">        ...         {</span>
<span class="sd">        ...             &quot;a&quot;: [0, 1, 2, 3],</span>
<span class="sd">        ...             &quot;b&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;],</span>
<span class="sd">        ...             &quot;c&quot;: [1, 1, 1, 1],</span>
<span class="sd">        ...             &quot;d&quot;: [&quot;2&quot;, &quot;2&quot;, &quot;2&quot;, &quot;2&quot;],</span>
<span class="sd">        ...             &quot;n&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;],</span>
<span class="sd">        ...         }</span>
<span class="sd">        ...     )</span>
<span class="sd">        ... )</span>
<span class="sd">        ... right = left.where(&quot;a in (&quot;1&quot;, &quot;2&quot;)&quot;)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Check</span>
<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Check&quot;}</span>
<span class="sd">        &gt;&gt;&gt; left.show()</span>
<span class="sd">        &gt;&gt;&gt; right.show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | a | b | c | d | n |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | 1 | a | 1 | 2 | a |</span>
<span class="sd">        | 2 | b | 1 | 2 | b |</span>
<span class="sd">        | 3 | c | 1 | 2 | c |</span>
<span class="sd">        | 4 | d | 1 | 2 | d |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | a | b | c | d | n |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | 1 | a | 1 | 2 | a |</span>
<span class="sd">        | 2 | b | 1 | 2 | b |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 1: Single column&quot;}</span>
<span class="sd">        &gt;&gt;&gt; drop_matching_rows(</span>
<span class="sd">        ...     left_table=left,</span>
<span class="sd">        ...     right_table=right,</span>
<span class="sd">        ...     on_keys=[&quot;a&quot;],</span>
<span class="sd">        ... ).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | a | b | c | d | n |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | 3 | c | 1 | 2 | c |</span>
<span class="sd">        | 4 | d | 1 | 2 | d |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully removed the records from the `left_table` which are existing on the `right_table`.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 2: Single column as string&quot;}</span>
<span class="sd">        &gt;&gt;&gt; left.transform(</span>
<span class="sd">        ...     drop_matching_rows,</span>
<span class="sd">        ...     right_table=right,</span>
<span class="sd">        ...     on_keys=&quot;a&quot;,</span>
<span class="sd">        ... ).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | a | b | c | d | n |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | 3 | c | 1 | 2 | c |</span>
<span class="sd">        | 4 | d | 1 | 2 | d |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully removed the records from the `left_table` which are existing on the `right_table`.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 3: Multiple key columns&quot;}</span>
<span class="sd">        &gt;&gt;&gt; drop_matching_rows(</span>
<span class="sd">        ...     left_table=left,</span>
<span class="sd">        ...     right_table=right,</span>
<span class="sd">        ...     on_keys=[&quot;a&quot;, &quot;b&quot;],</span>
<span class="sd">        ... ).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | a | b | c | d | n |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | 3 | c | 1 | 2 | c |</span>
<span class="sd">        | 4 | d | 1 | 2 | d |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully removed the records from the `left_table` which are existing on the `right_table`.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 4: Including `where` clause&quot;}</span>
<span class="sd">        &gt;&gt;&gt; drop_matching_rows(</span>
<span class="sd">        ...     left_table=left,</span>
<span class="sd">        ...     right_table=right,</span>
<span class="sd">        ...     on_keys=[&quot;a&quot;],</span>
<span class="sd">        ...     where_clause=&quot;n &lt;&gt; &#39;d&#39;&quot;,</span>
<span class="sd">        ... ).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | a | b | c | d | n |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | 3 | c | 1 | 2 | c |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully removed the records from the `left_table` which are existing on the `right_table` and matched the `where` clause.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 5: Part of pipe&quot;}</span>
<span class="sd">        &gt;&gt;&gt; left.transform(</span>
<span class="sd">        ...     func=drop_matching_rows,</span>
<span class="sd">        ...     right_table=right,</span>
<span class="sd">        ...     on_keys=[&quot;a&quot;],</span>
<span class="sd">        ... ).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | a | b | c | d | n |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | 3 | c | 1 | 2 | c |</span>
<span class="sd">        | 4 | d | 1 | 2 | d |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully removed the records from the `left_table` which are existing on the `right_table`.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 6: Invalid column&quot;}</span>
<span class="sd">        &gt;&gt;&gt; drop_matching_rows(</span>
<span class="sd">        ...     left_table=left,</span>
<span class="sd">        ...     right_table=right,</span>
<span class="sd">        ...     on_keys=[&quot;f&quot;],</span>
<span class="sd">        ... )</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        ColumnDoesNotExistError: Columns [&#39;f&#39;] do not exist in the DataFrame.</span>
<span class="sd">        Try one of: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;n&quot;]</span>
<span class="sd">        ```</span>
<span class="sd">        !!! failure &quot;Conclusion: Columns do not exist.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">    ??? info &quot;Notes&quot;</span>
<span class="sd">        - The `on_keys` parameter can be a single string or a list of strings. This is to allow for multiple columns to be used as the matching keys.</span>
<span class="sd">        - The `where_clause` parameter is optional. If specified, then only the records which match the condition will be kept on the `left_table`. It is applied after the join. If not specified, then all records which are existing on the `right_table` will be removed from the `left_table`.</span>

<span class="sd">    ??? tip &quot;See Also&quot;</span>
<span class="sd">        - [`assert_columns_exists()`][toolbox_pyspark.checks.assert_columns_exists]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">on_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">on_keys</span><span class="p">]</span> <span class="k">if</span> <span class="n">is_type</span><span class="p">(</span><span class="n">on_keys</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">on_keys</span>
    <span class="n">assert_columns_exists</span><span class="p">(</span><span class="n">left_table</span><span class="p">,</span> <span class="n">on_keys</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">assert_columns_exists</span><span class="p">(</span><span class="n">right_table</span><span class="p">,</span> <span class="n">on_keys</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">left_table</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">right_table</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">),</span> <span class="n">on</span><span class="o">=</span><span class="n">on_keys</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="n">join_type</span><span class="p">)</span>
        <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;1=1&quot;</span> <span class="k">if</span> <span class="n">where_clause</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">where_clause</span><span class="p">)</span>
        <span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;left.</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">left_table</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.indexes", "navigation.top", "navigation.instant", "search.highlight", "search.suggest", "toc.follow", "content.action.edit", "content.action.view"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  </body>
</html>