
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Helper files/functions/classes for generic PySpark processes">
      
      
        <meta name="author" content="[Chris Mahoney](mailto:chris@mahoneyconsultingservices.com)">
      
      
      
        <link rel="prev" href="../cleaning/">
      
      
        <link rel="next" href="../schema/">
      
      
      <link rel="icon" href="../../assets/images/spark.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Duplication - PySpark Toolbox</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/style.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/admonitions.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/code_chunks.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/columns.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/lists.css">
    
      <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.4.2/css/all.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#toolbox_pyspark.duplication" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="PySpark Toolbox" class="md-header__button md-logo" aria-label="PySpark Toolbox" data-md-component="logo">
      
  <img src="../../assets/images/spark.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PySpark Toolbox
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Duplication
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/data-science-extensions/toolbox-pyspark" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m21.94 13.11-1.05-3.22c0-.03-.01-.06-.02-.09l-2.11-6.48a.86.86 0 0 0-.8-.57c-.36 0-.68.25-.79.58l-2 6.17H8.84L6.83 3.33a.85.85 0 0 0-.79-.58c-.37 0-.69.25-.8.58L3.13 9.82v.01l-1.07 3.28c-.16.5.01 1.04.44 1.34l9.22 6.71c.17.12.39.12.56-.01l9.22-6.7c.43-.3.6-.84.44-1.34M8.15 10.45l2.57 7.91-6.17-7.91m8.73 7.92 2.47-7.59.1-.33h3.61l-5.59 7.16m4.1-13.67 1.81 5.56h-3.62m-1.3.95-1.79 5.51L12 19.24l-2.86-8.79M6.03 3.94 7.84 9.5H4.23m-1.18 4.19c-.09-.07-.13-.19-.09-.29l.79-2.43 5.82 7.45m11.38-4.73-6.51 4.73.02-.03 5.79-7.42.79 2.43c.04.1 0 .22-.09.29"/></svg>
  </div>
  <div class="md-source__repository">
    toolbox-pyspark
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../usage/overview/" class="md-tabs__link">
          
  
    
  
  Usage

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  Modules

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PySpark Toolbox" class="md-nav__button md-logo" aria-label="PySpark Toolbox" data-md-component="logo">
      
  <img src="../../assets/images/spark.svg" alt="logo">

    </a>
    PySpark Toolbox
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/data-science-extensions/toolbox-pyspark" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m21.94 13.11-1.05-3.22c0-.03-.01-.06-.02-.09l-2.11-6.48a.86.86 0 0 0-.8-.57c-.36 0-.68.25-.79.58l-2 6.17H8.84L6.83 3.33a.85.85 0 0 0-.79-.58c-.37 0-.69.25-.8.58L3.13 9.82v.01l-1.07 3.28c-.16.5.01 1.04.44 1.34l9.22 6.71c.17.12.39.12.56-.01l9.22-6.7c.43-.3.6-.84.44-1.34M8.15 10.45l2.57 7.91-6.17-7.91m8.73 7.92 2.47-7.59.1-.33h3.61l-5.59 7.16m4.1-13.67 1.81 5.56h-3.62m-1.3.95-1.79 5.51L12 19.24l-2.86-8.79M6.03 3.94 7.84 9.5H4.23m-1.18 4.19c-.09-.07-.13-.19-.09-.29l.79-2.43 5.82 7.45m11.38-4.73-6.51 4.73.02-.03 5.79-7.42.79 2.43c.04.1 0 .22-.09.29"/></svg>
  </div>
  <div class="md-source__repository">
    toolbox-pyspark
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Usage
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/roadmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Roadmap
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Modules
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constants/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Constants
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IO
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../checks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Checks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../keys/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Keys
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scale/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scale
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dimensions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dimensions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../columns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Columns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datetime/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DateTime
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cleaning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cleaning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Duplication
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Duplication
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#toolbox_pyspark.duplication" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;duplication
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" duplication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.duplication.duplicate_union_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;duplicate_union_dataframe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.duplication.union_all" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;union_all
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Schema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../delta/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delta
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#toolbox_pyspark.duplication" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;duplication
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" duplication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.duplication.duplicate_union_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;duplicate_union_dataframe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolbox_pyspark.duplication.union_all" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;union_all
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/data-science-extensions/toolbox-pyspark/edit/main/docs/code/duplication.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/data-science-extensions/toolbox-pyspark/raw/main/docs/code/duplication.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


  <h1>Duplication</h1>

<div class="doc doc-object doc-module">



<h3 id="toolbox_pyspark.duplication" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">toolbox_pyspark.duplication</span>


<a href="#toolbox_pyspark.duplication" class="headerlink" title="Permanent link">🔗</a></h3>

    <div class="doc doc-contents first">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>The <code>duplication</code> module is used for duplicating data from an existing <code>dataframe</code>, or unioning multiple <code>dataframe</code>'s together.</p>
</div>








  <div class="doc doc-children">



























<div class="doc doc-object doc-function">


<h4 id="toolbox_pyspark.duplication.duplicate_union_dataframe" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">duplicate_union_dataframe</span>


<a href="#toolbox_pyspark.duplication.duplicate_union_dataframe" class="headerlink" title="Permanent link">🔗</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">duplicate_union_dataframe</span><span class="p">(</span>
    <span class="n">dataframe</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">by_list</span><span class="p">:</span> <span class="n">str_list</span><span class="p">,</span>
    <span class="n">new_column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>The purpose here is to take a given table and duplicate it entirely multiple times from values in a list, then union them all together.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>There are sometimes instances where we need to duplicate an entire table multiple times, with no change to the underlying data. Sometimes this is to maintain the structure of the data, but duplicate it to match a different table structure. This function is designed to do just that.<br>
The <code>dataframe</code> is the table to be duplicated, the <code>by_list</code> is the list of values to loop over, and the <code>new_column_name</code> is the new column to hold the loop values.</p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataframe</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The table to be duplicated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>by_list</code>
            </td>
            <td>
                  <code><span title="toolbox_python.collection_types.str_list">str_list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list to loop over.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>new_column_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The new column to hold the loop values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>TypeError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any of the inputs parsed to the parameters of this function are not the correct type. Uses the <a href="https://typeguard.readthedocs.io/en/stable/api.html#typeguard.typechecked"><code>@typeguard.typechecked</code></a> decorator.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>AttributeError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any given value in the <code>by_list</code> list is not a string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The updated DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Set up</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Imports</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">toolbox_pyspark.duplication</span> <span class="kn">import</span> <span class="n">duplicate_union_dataframe</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Instantiate Spark</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="o">...</span>         <span class="p">{</span>
<span class="o">...</span>             <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="o">...</span>         <span class="p">}</span>
<span class="o">...</span>     <span class="p">)</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Check</span>
<span class="err">```</span><span class="p">{</span><span class="o">.</span><span class="n">py</span> <span class="o">.</span><span class="n">python</span> <span class="n">linenums</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Check&quot;</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+
| a | b | c | d |
+---+---+---+---+
| 1 | a | x | 2 |
| 2 | b | x | 2 |
| 3 | c | x | 2 |
| 4 | d | x | 2 |
+---+---+---+---+
</code></pre></div>
</div></p>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Column missing</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">duplicate_union_dataframe</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">dataframe</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">by_list</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">new_column_name</span><span class="o">=</span><span class="s2">&quot;n&quot;</span><span class="p">,</span>
<span class="o">...</span> <span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+---+
| a | b | c | d | n |
+---+---+---+---+---+
| 1 | a | x | 2 | x |
| 2 | b | x | 2 | x |
| 3 | c | x | 2 | x |
| 4 | d | x | 2 | x |
| 1 | a | x | 2 | y |
| 2 | b | x | 2 | y |
| 3 | c | x | 2 | y |
| 4 | d | x | 2 | y |
| 1 | a | x | 2 | z |
| 2 | b | x | 2 | z |
| 3 | c | x | 2 | z |
| 4 | d | x | 2 | z |
+---+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully duplicated data frame multiple times.</p>
</div>
</div>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Column existing</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">duplicate_union_dataframe</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">dataframe</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">by_list</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">],</span>
<span class="o">...</span>     <span class="n">new_column_name</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">,</span>
<span class="o">...</span> <span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+
| a | b | c | d |
+---+---+---+---+
| 1 | a | x | 2 |
| 2 | b | x | 2 |
| 3 | c | x | 2 |
| 4 | d | x | 2 |
| 1 | a | y | 2 |
| 2 | b | y | 2 |
| 3 | c | y | 2 |
| 4 | d | y | 2 |
| 1 | a | z | 2 |
| 2 | b | z | 2 |
| 3 | c | z | 2 |
| 4 | d | z | 2 |
+---+---+---+---+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully duplicated data frame multiple times.</p>
</div>
</div>
</details>
<details class="info">
<summary>Notes</summary>
<ul>
<li>How the <code>union</code> is performed:<ul>
<li>Currently this function uses the <code>loop</code> and <code>append</code> method.</li>
<li>It was written this way because it's a lot easier and more logical for humans to understand.</li>
<li>However, there's probably a more computationally efficient method for doing this by using SQL Joins.</li>
<li>More specifically, for creating a CARTESIAN PRODUCT (aka a 'Cross-Join') over the data set.</li>
<li>This is probably one of the only times EVER that a developer would <em>want</em> to create a cartesian product.</li>
<li>All other times a cartesian product is to be avoided at all costs...</li>
</ul>
</li>
<li>Whether or not the column <code>new_column_name</code> exists or not on the <code>dataframe</code>:<ul>
<li>The process is a little different for if the <code>new_column_name</code> is existing or not...</li>
<li>If it is existing, we need to:<ul>
<li>Extract the <code class="highlight"><span class="k">distinct</span></code> values from that column,</li>
<li>Create a duplicate copy of the raw table,</li>
<li>Loop through all values in <code>by_list</code>,</li>
<li>Check if that <code>value</code> from <code>by_list</code> is already existing in the extracted values from the <code>new_column_name</code> column,</li>
<li>If it is already existing, proceed to next iteration,</li>
<li>If it is not existing, take the raw table, update <code>new_column_name</code> to be the <code>value</code> from that iteration of <code>by_list</code>, then <code class="highlight"><span class="k">union</span></code> that to the copy of the raw table,</li>
<li>Continue to iterate through all values in <code>by_list</code> until they're all <code class="highlight"><span class="k">union</span></code>'ed together.</li>
</ul>
</li>
<li>If it is not existing, we need to:<ul>
<li>Add a new column to <code>dataframe</code> that has the name from <code>new_column_name</code>, and a single literal value from the zero'th index of the <code>by_list</code>,</li>
<li>Then to go through the same process as if the column were existing.</li>
</ul>
</li>
<li>Having now achieved this, the final output <code>dataframe</code> will now have all the updated duplicate values that we require.</li>
</ul>
</li>
</ul>
</details>
<details class="warning" open="open">
<summary>Warning</summary>
<p>Obviously, it's easy to see how this function will blow out the size of a table to tremendious sizes. So be careful!</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/toolbox_pyspark/duplication.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span> <span class="nf">duplicate_union_dataframe</span><span class="p">(</span>
    <span class="n">dataframe</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">by_list</span><span class="p">:</span> <span class="n">str_list</span><span class="p">,</span>
    <span class="n">new_column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        The purpose here is to take a given table and duplicate it entirely multiple times from values in a list, then union them all together.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>
<span class="sd">        There are sometimes instances where we need to duplicate an entire table multiple times, with no change to the underlying data. Sometimes this is to maintain the structure of the data, but duplicate it to match a different table structure. This function is designed to do just that.&lt;br&gt;</span>
<span class="sd">        The `dataframe` is the table to be duplicated, the `by_list` is the list of values to loop over, and the `new_column_name` is the new column to hold the loop values.</span>

<span class="sd">    Params:</span>
<span class="sd">        dataframe (psDataFrame):</span>
<span class="sd">            The table to be duplicated.</span>
<span class="sd">        by_list (str_list):</span>
<span class="sd">            The list to loop over.</span>
<span class="sd">        new_column_name (str):</span>
<span class="sd">            The new column to hold the loop values.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError:</span>
<span class="sd">            If any of the inputs parsed to the parameters of this function are not the correct type. Uses the [`@typeguard.typechecked`](https://typeguard.readthedocs.io/en/stable/api.html#typeguard.typechecked) decorator.</span>
<span class="sd">        AttributeError:</span>
<span class="sd">            If any given value in the `by_list` list is not a string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (psDataFrame):</span>
<span class="sd">            The updated DataFrame.</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Set up&quot;}</span>
<span class="sd">        &gt;&gt;&gt; # Imports</span>
<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; from pyspark.sql import SparkSession</span>
<span class="sd">        &gt;&gt;&gt; from toolbox_pyspark.duplication import duplicate_union_dataframe</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Instantiate Spark</span>
<span class="sd">        &gt;&gt;&gt; spark = SparkSession.builder.getOrCreate()</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Create data</span>
<span class="sd">        &gt;&gt;&gt; df = spark.createDataFrame(</span>
<span class="sd">        ...     pd.DataFrame(</span>
<span class="sd">        ...         {</span>
<span class="sd">        ...             &quot;a&quot;: [1, 2, 3, 4],</span>
<span class="sd">        ...             &quot;b&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;],</span>
<span class="sd">        ...             &quot;c&quot;: [&quot;x&quot;, &quot;x&quot;, &quot;x&quot;, &quot;x&quot;],</span>
<span class="sd">        ...             &quot;d&quot;: [2, 2, 2, 2],</span>
<span class="sd">        ...         }</span>
<span class="sd">        ...     )</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Check</span>
<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Check&quot;}</span>
<span class="sd">        &gt;&gt;&gt; df.show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | a | b | c | d |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | 1 | a | x | 2 |</span>
<span class="sd">        | 2 | b | x | 2 |</span>
<span class="sd">        | 3 | c | x | 2 |</span>
<span class="sd">        | 4 | d | x | 2 |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 1: Column missing&quot;}</span>
<span class="sd">        &gt;&gt;&gt; duplicate_union_dataframe(</span>
<span class="sd">        ...     dataframe=df,</span>
<span class="sd">        ...     by_list=[&quot;x&quot;, &quot;y&quot;, &quot;z&quot;],</span>
<span class="sd">        ...     new_column_name=&quot;n&quot;,</span>
<span class="sd">        ... ).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | a | b | c | d | n |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        | 1 | a | x | 2 | x |</span>
<span class="sd">        | 2 | b | x | 2 | x |</span>
<span class="sd">        | 3 | c | x | 2 | x |</span>
<span class="sd">        | 4 | d | x | 2 | x |</span>
<span class="sd">        | 1 | a | x | 2 | y |</span>
<span class="sd">        | 2 | b | x | 2 | y |</span>
<span class="sd">        | 3 | c | x | 2 | y |</span>
<span class="sd">        | 4 | d | x | 2 | y |</span>
<span class="sd">        | 1 | a | x | 2 | z |</span>
<span class="sd">        | 2 | b | x | 2 | z |</span>
<span class="sd">        | 3 | c | x | 2 | z |</span>
<span class="sd">        | 4 | d | x | 2 | z |</span>
<span class="sd">        +---+---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully duplicated data frame multiple times.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 2: Column existing&quot;}</span>
<span class="sd">        &gt;&gt;&gt; duplicate_union_dataframe(</span>
<span class="sd">        ...     dataframe=df,</span>
<span class="sd">        ...     by_list=[&quot;x&quot;, &quot;y&quot;, &quot;z&quot;],</span>
<span class="sd">        ...     new_column_name=&quot;c&quot;,</span>
<span class="sd">        ... ).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | a | b | c | d |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | 1 | a | x | 2 |</span>
<span class="sd">        | 2 | b | x | 2 |</span>
<span class="sd">        | 3 | c | x | 2 |</span>
<span class="sd">        | 4 | d | x | 2 |</span>
<span class="sd">        | 1 | a | y | 2 |</span>
<span class="sd">        | 2 | b | y | 2 |</span>
<span class="sd">        | 3 | c | y | 2 |</span>
<span class="sd">        | 4 | d | y | 2 |</span>
<span class="sd">        | 1 | a | z | 2 |</span>
<span class="sd">        | 2 | b | z | 2 |</span>
<span class="sd">        | 3 | c | z | 2 |</span>
<span class="sd">        | 4 | d | z | 2 |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully duplicated data frame multiple times.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">    ??? info &quot;Notes&quot;</span>
<span class="sd">        - How the `union` is performed:</span>
<span class="sd">            - Currently this function uses the `loop` and `append` method.</span>
<span class="sd">            - It was written this way because it&#39;s a lot easier and more logical for humans to understand.</span>
<span class="sd">            - However, there&#39;s probably a more computationally efficient method for doing this by using SQL Joins.</span>
<span class="sd">            - More specifically, for creating a CARTESIAN PRODUCT (aka a &#39;Cross-Join&#39;) over the data set.</span>
<span class="sd">            - This is probably one of the only times EVER that a developer would _want_ to create a cartesian product.</span>
<span class="sd">            - All other times a cartesian product is to be avoided at all costs...</span>
<span class="sd">        - Whether or not the column `new_column_name` exists or not on the `dataframe`:</span>
<span class="sd">            - The process is a little different for if the `new_column_name` is existing or not...</span>
<span class="sd">            - If it is existing, we need to:</span>
<span class="sd">                - Extract the `#!sql distinct` values from that column,</span>
<span class="sd">                - Create a duplicate copy of the raw table,</span>
<span class="sd">                - Loop through all values in `by_list`,</span>
<span class="sd">                - Check if that `value` from `by_list` is already existing in the extracted values from the `new_column_name` column,</span>
<span class="sd">                - If it is already existing, proceed to next iteration,</span>
<span class="sd">                - If it is not existing, take the raw table, update `new_column_name` to be the `value` from that iteration of `by_list`, then `#!sql union` that to the copy of the raw table,</span>
<span class="sd">                - Continue to iterate through all values in `by_list` until they&#39;re all `#!sql union`&#39;ed together.</span>
<span class="sd">            - If it is not existing, we need to:</span>
<span class="sd">                - Add a new column to `dataframe` that has the name from `new_column_name`, and a single literal value from the zero&#39;th index of the `by_list`,</span>
<span class="sd">                - Then to go through the same process as if the column were existing.</span>
<span class="sd">            - Having now achieved this, the final output `dataframe` will now have all the updated duplicate values that we require.</span>

<span class="sd">    ???+ warning &quot;Warning&quot;</span>
<span class="sd">        Obviously, it&#39;s easy to see how this function will blow out the size of a table to tremendious sizes. So be careful!</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_self_union_dataframe_with_column_existing</span><span class="p">(</span>
        <span class="n">dataframe</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
        <span class="n">by_list</span><span class="p">:</span> <span class="n">str_list</span><span class="p">,</span>
        <span class="n">new_column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span><span class="p">:</span>
        <span class="n">values_in_col</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="n">get_column_values</span><span class="p">(</span>
            <span class="n">dataframe</span><span class="o">=</span><span class="n">dataframe</span><span class="p">,</span>
            <span class="n">column</span><span class="o">=</span><span class="n">new_column_name</span><span class="p">,</span>
            <span class="n">distinct</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;flat_list&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">new_df</span><span class="p">:</span> <span class="n">psDataFrame</span> <span class="o">=</span> <span class="n">dataframe</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">by_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values_in_col</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="k">continue</span>
            <span class="n">new_df</span> <span class="o">=</span> <span class="n">new_df</span><span class="o">.</span><span class="n">unionAll</span><span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="n">new_column_name</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">value</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">new_df</span>

    <span class="k">def</span> <span class="nf">_self_union_dataframe_with_column_missing</span><span class="p">(</span>
        <span class="n">dataframe</span><span class="p">:</span> <span class="n">psDataFrame</span><span class="p">,</span>
        <span class="n">by_list</span><span class="p">:</span> <span class="n">str_list</span><span class="p">,</span>
        <span class="n">new_column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span><span class="p">:</span>
        <span class="n">new_df</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="n">new_column_name</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">by_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">_self_union_dataframe_with_column_existing</span><span class="p">(</span>
            <span class="n">dataframe</span><span class="o">=</span><span class="n">new_df</span><span class="p">,</span>
            <span class="n">by_list</span><span class="o">=</span><span class="n">by_list</span><span class="p">,</span>
            <span class="n">new_column_name</span><span class="o">=</span><span class="n">new_column_name</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">new_column_name</span> <span class="ow">in</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_self_union_dataframe_with_column_existing</span><span class="p">(</span>
            <span class="n">dataframe</span><span class="o">=</span><span class="n">dataframe</span><span class="p">,</span>
            <span class="n">by_list</span><span class="o">=</span><span class="n">by_list</span><span class="p">,</span>
            <span class="n">new_column_name</span><span class="o">=</span><span class="n">new_column_name</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_self_union_dataframe_with_column_missing</span><span class="p">(</span>
            <span class="n">dataframe</span><span class="o">=</span><span class="n">dataframe</span><span class="p">,</span>
            <span class="n">by_list</span><span class="o">=</span><span class="n">by_list</span><span class="p">,</span>
            <span class="n">new_column_name</span><span class="o">=</span><span class="n">new_column_name</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="toolbox_pyspark.duplication.union_all" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">union_all</span>


<a href="#toolbox_pyspark.duplication.union_all" class="headerlink" title="Permanent link">🔗</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">union_all</span><span class="p">(</span><span class="n">dfs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">psDataFrame</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>Take a list of <code>dataframes</code>, and union them all together.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>If any columns are missing or added in any of the <code>dataframes</code> within <code>dfs</code>, then they will be automatically handled with the <code>allowMissingColumns</code> parameter, and any of the other <code>dataframes</code> will simply contain <code class="highlight"><span class="k">null</span></code> values for those columns which they are missing.</p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dfs</code>
            </td>
            <td>
                  <code>list[<span title="pyspark.sql.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of <code>dataframe</code>'s to union together.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>TypeError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any of the inputs parsed to the parameters of this function are not the correct type. Uses the <a href="https://typeguard.readthedocs.io/en/stable/api.html#typeguard.typechecked"><code>@typeguard.typechecked</code></a> decorator.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A single <code>dataframe</code> containing a union of all the <code>dataframe</code>s.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Set up</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Imports</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">toolbox_pyspark.duplication</span> <span class="kn">import</span> <span class="n">duplicate_union_dataframe</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Instantiate Spark</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df1</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="o">...</span>         <span class="p">{</span>
<span class="o">...</span>             <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>             <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="o">...</span>         <span class="p">})</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df2</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="o">...</span>         <span class="p">{</span>
<span class="o">...</span>             <span class="s2">&quot;a&#39;: [1, 2, 3, 4],</span>
<span class="o">...</span>             <span class="s2">&quot;b&#39;: [&quot;</span><span class="n">a</span><span class="s2">&quot;, &quot;</span><span class="sa">b</span><span class="s2">&quot;, &quot;</span><span class="n">c</span><span class="s2">&quot;, &quot;</span><span class="n">d</span><span class="s2">&quot;],</span>
<span class="o">...</span>             <span class="s2">&quot;c&#39;: [1, 1, 1, 1],</span>
<span class="o">...</span>     <span class="p">})</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df3</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="o">...</span>         <span class="p">{</span>
<span class="o">...</span>             <span class="s2">&quot;a&#39;: [1, 2, 3, 4],</span>
<span class="o">...</span>             <span class="s2">&quot;b&#39;: [&quot;</span><span class="n">a</span><span class="s2">&quot;, &quot;</span><span class="sa">b</span><span class="s2">&quot;, &quot;</span><span class="n">c</span><span class="s2">&quot;, &quot;</span><span class="n">d</span><span class="s2">&quot;],</span>
<span class="o">...</span>             <span class="s2">&quot;c&#39;: [1, 1, 1, 1],</span>
<span class="o">...</span>             <span class="s2">&quot;e&#39;: [3, 3, 3, 3],</span>
<span class="o">...</span>     <span class="p">})</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Check</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">dfs</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+
| a | b | c | d |
+---+---+---+---+
| 1 | a | 1 | 2 |
| 2 | b | 1 | 2 |
| 3 | c | 1 | 2 |
| 4 | d | 1 | 2 |
+---+---+---+---+
</code></pre></div>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+
| a | b | c |
+---+---+---+
| 1 | a | 1 |
| 2 | b | 1 |
| 3 | c | 1 |
| 4 | d | 1 |
+---+---+---+
</code></pre></div>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+---+
| a | b | c | e |
+---+---+---+---+
| 1 | a | 1 | 3 |
| 2 | b | 1 | 3 |
| 3 | c | 1 | 3 |
| 4 | d | 1 | 3 |
+---+---+---+---+
</code></pre></div>
</div></p>
<p><div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Basic usage</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">union_all</span><span class="p">(</span><span class="n">dfs</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="text highlight"><span class="filename">Terminal</span><pre><span></span><code>+---+---+---+------+------+
| a | b | c |    d |    e |
+---+---+---+------+------+
| 1 | a | 1 |    2 | null |
| 2 | b | 1 |    2 | null |
| 3 | c | 1 |    2 | null |
| 4 | d | 1 |    2 | null |
| 1 | a | 1 | null | null |
| 2 | b | 1 | null | null |
| 3 | c | 1 | null | null |
| 4 | d | 1 | null | null |
| 1 | a | 1 | null |    3 |
| 2 | b | 1 | null |    3 |
| 3 | c | 1 | null |    3 |
| 4 | d | 1 | null |    3 |
+---+---+---+------+------+
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Conclusion: Successfully unioned all data frames together.</p>
</div>
</div>
</details>

            <details class="quote">
              <summary>Source code in <code>src/toolbox_pyspark/duplication.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span> <span class="nf">union_all</span><span class="p">(</span><span class="n">dfs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">psDataFrame</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">psDataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        Take a list of `dataframes`, and union them all together.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>
<span class="sd">        If any columns are missing or added in any of the `dataframes` within `dfs`, then they will be automatically handled with the `allowMissingColumns` parameter, and any of the other `dataframes` will simply contain `#!sql null` values for those columns which they are missing.</span>

<span class="sd">    Params:</span>
<span class="sd">        dfs (list[psDataFrame]):</span>
<span class="sd">            The list of `dataframe`&#39;s to union together.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError:</span>
<span class="sd">            If any of the inputs parsed to the parameters of this function are not the correct type. Uses the [`@typeguard.typechecked`](https://typeguard.readthedocs.io/en/stable/api.html#typeguard.typechecked) decorator.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (psDataFrame):</span>
<span class="sd">            A single `dataframe` containing a union of all the `dataframe`s.</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>
<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Set up&quot;}</span>
<span class="sd">        &gt;&gt;&gt; # Imports</span>
<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; from pyspark.sql import SparkSession</span>
<span class="sd">        &gt;&gt;&gt; from toolbox_pyspark.duplication import duplicate_union_dataframe</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Instantiate Spark</span>
<span class="sd">        &gt;&gt;&gt; spark = SparkSession.builder.getOrCreate()</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Create data</span>
<span class="sd">        &gt;&gt;&gt; df1 = spark.createDataFrame(</span>
<span class="sd">        ...     pd.DataFrame(</span>
<span class="sd">        ...         {</span>
<span class="sd">        ...             &quot;a&quot;: [1, 2, 3, 4],</span>
<span class="sd">        ...             &quot;b&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;],</span>
<span class="sd">        ...             &quot;c&quot;: [1, 1, 1, 1],</span>
<span class="sd">        ...             &quot;d&quot;: [2, 2, 2, 2],</span>
<span class="sd">        ...         })</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df2 = spark.createDataFrame(</span>
<span class="sd">        ...     pd.DataFrame(</span>
<span class="sd">        ...         {</span>
<span class="sd">        ...             &quot;a&#39;: [1, 2, 3, 4],</span>
<span class="sd">        ...             &quot;b&#39;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;],</span>
<span class="sd">        ...             &quot;c&#39;: [1, 1, 1, 1],</span>
<span class="sd">        ...     })</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df3 = spark.createDataFrame(</span>
<span class="sd">        ...     pd.DataFrame(</span>
<span class="sd">        ...         {</span>
<span class="sd">        ...             &quot;a&#39;: [1, 2, 3, 4],</span>
<span class="sd">        ...             &quot;b&#39;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;],</span>
<span class="sd">        ...             &quot;c&#39;: [1, 1, 1, 1],</span>
<span class="sd">        ...             &quot;e&#39;: [3, 3, 3, 3],</span>
<span class="sd">        ...     })</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; dfs = [df1, df2, df3]</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Check</span>
<span class="sd">        &gt;&gt;&gt; for df in dfs:</span>
<span class="sd">        ...     df.show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | a | b | c | d |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | 1 | a | 1 | 2 |</span>
<span class="sd">        | 2 | b | 1 | 2 |</span>
<span class="sd">        | 3 | c | 1 | 2 |</span>
<span class="sd">        | 4 | d | 1 | 2 |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+</span>
<span class="sd">        | a | b | c |</span>
<span class="sd">        +---+---+---+</span>
<span class="sd">        | 1 | a | 1 |</span>
<span class="sd">        | 2 | b | 1 |</span>
<span class="sd">        | 3 | c | 1 |</span>
<span class="sd">        | 4 | d | 1 |</span>
<span class="sd">        +---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | a | b | c | e |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        | 1 | a | 1 | 3 |</span>
<span class="sd">        | 2 | b | 1 | 3 |</span>
<span class="sd">        | 3 | c | 1 | 3 |</span>
<span class="sd">        | 4 | d | 1 | 3 |</span>
<span class="sd">        +---+---+---+---+</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">        ```{.py .python linenums=&quot;1&quot; title=&quot;Example 1: Basic usage&quot;}</span>
<span class="sd">        &gt;&gt;&gt; union_all(dfs).show()</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;div class=&quot;result&quot; markdown&gt;</span>
<span class="sd">        ```{.txt .text title=&quot;Terminal&quot;}</span>
<span class="sd">        +---+---+---+------+------+</span>
<span class="sd">        | a | b | c |    d |    e |</span>
<span class="sd">        +---+---+---+------+------+</span>
<span class="sd">        | 1 | a | 1 |    2 | null |</span>
<span class="sd">        | 2 | b | 1 |    2 | null |</span>
<span class="sd">        | 3 | c | 1 |    2 | null |</span>
<span class="sd">        | 4 | d | 1 |    2 | null |</span>
<span class="sd">        | 1 | a | 1 | null | null |</span>
<span class="sd">        | 2 | b | 1 | null | null |</span>
<span class="sd">        | 3 | c | 1 | null | null |</span>
<span class="sd">        | 4 | d | 1 | null | null |</span>
<span class="sd">        | 1 | a | 1 | null |    3 |</span>
<span class="sd">        | 2 | b | 1 | null |    3 |</span>
<span class="sd">        | 3 | c | 1 | null |    3 |</span>
<span class="sd">        | 4 | d | 1 | null |    3 |</span>
<span class="sd">        +---+---+---+------+------+</span>
<span class="sd">        ```</span>
<span class="sd">        !!! success &quot;Conclusion: Successfully unioned all data frames together.&quot;</span>
<span class="sd">        &lt;/div&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dfs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unionByName</span><span class="p">(</span><span class="n">union_all</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span> <span class="n">allowMissingColumns</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dfs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.indexes", "navigation.top", "navigation.instant", "search.highlight", "search.suggest", "toc.follow", "content.action.edit", "content.action.view", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  </body>
</html>